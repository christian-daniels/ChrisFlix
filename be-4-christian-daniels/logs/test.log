[2021/03/17 18:19:34][CONFIG][initService]  Starting service...
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Scheme: http://
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Hostname: 0.0.0.0
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Port: 12348
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Path: /api/billing
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Logger output directory: ./logs/
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Database hostname: localhost
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Database port: 3306
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Database username: root
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Database password provided? true
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Database name: billing
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Database driver: com.mysql.cj.jdbc.Driver
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Database connection settings: ?autoReconnect=true&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=PST
[2021/03/17 18:19:34][CONFIG][currentConfigs]  IDM Scheme: http://
[2021/03/17 18:19:34][CONFIG][currentConfigs]  IDM Hostname: 0.0.0.0
[2021/03/17 18:19:34][CONFIG][currentConfigs]  IDM Port: 12346
[2021/03/17 18:19:34][CONFIG][currentConfigs]  IDM Path: /api/idm
[2021/03/17 18:19:34][CONFIG][currentConfigs]  IDM Privilege Path: /privilege
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Movies Scheme: http://
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Movies Hostname: 0.0.0.0
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Movies Port: 12347
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Movies Path: /api/movies
[2021/03/17 18:19:34][CONFIG][currentConfigs]  Movies Thumbnail Path: /thumbnail
[2021/03/17 18:19:34][CONFIG][connectToDatabase]  Connecting to database...
[2021/03/17 18:19:34][CONFIG][connectToDatabase]  Database URL: jdbc:mysql://localhost:3306/billing?autoReconnect=true&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=PST
[2021/03/17 18:19:35][CONFIG][connectToDatabase]  Connected to database: jdbc:mysql://localhost:3306/billing?autoReconnect=true&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=PST
[2021/03/17 18:19:35][CONFIG][initHTTPServer]  Initializing HTTP server...
[2021/03/17 18:19:35][CONFIG][initHTTPServer]  Building URI from configs...
[2021/03/17 18:19:35][CONFIG][initHTTPServer]  Final URI: http://0.0.0.0:12348/api/billing
[2021/03/17 18:19:35][CONFIG][initHTTPServer]  Set Jersey resources.
[2021/03/17 18:19:35][CONFIG][initHTTPServer]  Set Jackson as serializer.
[2021/03/17 18:19:35][CONFIG][initHTTPServer]  Starting HTTP server...
[2021/03/17 18:19:35][CONFIG][initHTTPServer]  HTTP server started.
[2021/03/17 18:19:35][CONFIG][initService]  Service initialized.
[2021/03/17 18:19:39][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'peteranteater@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'peteranteater@uci.edu';
[2021/03/17 18:19:39][INFO][orderPlace]  Query succeeded
[2021/03/17 18:19:39][INFO][orderPlace]  Found an sale_id: 52
[2021/03/17 18:19:39][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (52,52);
[2021/03/17 18:19:39][INFO][orderPlace]  Sum was 20.914800911140446
[2021/03/17 18:19:41][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:19:41][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:19:41][INFO][createPayPalOrder]  Order ID: 41E24528A18344744
[2021/03/17 18:19:41][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:19:41][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (52,'41E24528A18344744');
[2021/03/17 18:19:41][INFO][orderPlace]  Getting Order details
[2021/03/17 18:19:41][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:19:38Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"20.91","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/41E24528A18344744"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=41E24528A18344744"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/41E24528A18344744"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/41E24528A18344744/capture"}],"id":"41E24528A18344744","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:19:41][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=41E24528A18344744
[2021/03/17 18:20:51][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 18:20:53][INFO][captureOrder]  Capture ID: 6LY44830ES109820G
[2021/03/17 18:20:53][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '6LY44830ES109820G' WHERE token = '41E24528A18344744';
[2021/03/17 18:20:53][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '41E24528A18344744';
[2021/03/17 18:20:59][INFO][orderRetrieve]  Found token: 41E24528A18344744
[2021/03/17 18:20:59][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T01:20:50Z","create_time":"2021-03-18T01:19:38Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"20.91","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"20.91","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T01:20:50Z","create_time":"2021-03-18T01:20:50Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"0.91","currency_code":"USD"},"gross_amount":{"value":"20.91","currency_code":"USD"},"net_amount":{"value":"20.00","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/6LY44830ES109820G"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/6LY44830ES109820G/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/41E24528A18344744"}],"id":"6LY44830ES109820G","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/41E24528A18344744"}],"id":"41E24528A18344744","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 18:24:45][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 18:24:45][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 18:24:45][INFO][sendIdmRequest]  Building client...
[2021/03/17 18:24:45][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 18:24:45][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 18:24:45][INFO][isAuthenticated]  Reading entity.
[2021/03/17 18:24:45][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 18:24:45][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'peteranteater@uci.edu' AND cart.movie_id = 'tt0308514';
[2021/03/17 18:24:45][INFO][cartInsert]  Query succeeded
[2021/03/17 18:24:45][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('peteranteater@uci.edu', 'tt0308514', 2);
[2021/03/17 18:24:45][INFO][cartInsert]  Update succeeded
[2021/03/17 18:24:49][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'peteranteater@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'peteranteater@uci.edu';
[2021/03/17 18:24:49][INFO][orderPlace]  Query succeeded
[2021/03/17 18:24:49][INFO][orderPlace]  Found an sale_id: 53
[2021/03/17 18:24:49][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (53,53);
[2021/03/17 18:24:49][INFO][orderPlace]  Sum was 20.914800911140446
[2021/03/17 18:24:50][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:24:50][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:24:50][INFO][createPayPalOrder]  Order ID: 6W163783HP780610N
[2021/03/17 18:24:50][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:24:50][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (53,'6W163783HP780610N');
[2021/03/17 18:24:50][INFO][orderPlace]  Getting Order details
[2021/03/17 18:24:51][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:24:48Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"20.91","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6W163783HP780610N"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=6W163783HP780610N"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6W163783HP780610N"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6W163783HP780610N/capture"}],"id":"6W163783HP780610N","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:24:51][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=6W163783HP780610N
[2021/03/17 18:24:56][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 18:24:57][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 18:24:57][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_NOT_APPROVED","description":"Payer has not yet approved the Order for payment. Please redirect the payer to the 'rel':'approve' url returned as part of the HATEOAS links within the Create Order call or provide a valid payment_source in the request."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"1cc87444216c6","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_NOT_APPROVED","rel":"information_link","method":"GET"}]}
[2021/03/17 18:24:57][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '6W163783HP780610N';
[2021/03/17 18:24:57][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '6W163783HP780610N';
[2021/03/17 18:25:01][INFO][orderRetrieve]  Found token: 41E24528A18344744
[2021/03/17 18:25:01][INFO][orderRetrieve]  Found token: 6W163783HP780610N
[2021/03/17 18:25:01][INFO][getOrderDetailed]  Full response body:{"create_time":"2021-03-18T01:24:48Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"20.91","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6W163783HP780610N"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=6W163783HP780610N"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6W163783HP780610N"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6W163783HP780610N/capture"}],"id":"6W163783HP780610N","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:29:38][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:29:38][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:29:38][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:29:38][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:29:38][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:29:38][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:29:38][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:29:38][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:29:47][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 18:29:47][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 18:29:47][INFO][sendIdmRequest]  Building client...
[2021/03/17 18:29:47][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 18:29:47][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 18:29:47][INFO][isAuthenticated]  Reading entity.
[2021/03/17 18:29:47][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 18:29:47][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 18:29:47][INFO][cartInsert]  Query succeeded
[2021/03/17 18:29:47][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('rememberme@uci.edu', 'tt4154796', 1);
[2021/03/17 18:29:47][INFO][cartInsert]  Update succeeded
[2021/03/17 18:29:47][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 18:29:47][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 18:29:47][INFO][sendIdmRequest]  Building client...
[2021/03/17 18:29:47][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 18:29:47][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 18:29:47][INFO][isAuthenticated]  Reading entity.
[2021/03/17 18:29:47][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 18:29:47][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 18:29:47][INFO][cartInsert]  Query succeeded
[2021/03/17 18:29:47][INFO][cartInsert]  Found a duplicate
[2021/03/17 18:29:49][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:29:49][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:29:49][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:29:49][INFO][cartRetrieve]  Found an item
[2021/03/17 18:29:49][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 18:29:49][INFO][sendMovieRequest]  Building client...
[2021/03/17 18:29:49][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 18:29:49][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 18:29:49][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 18:29:49][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 18:29:49][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 18:29:49][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 18:29:49][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:29:49][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:29:49][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:29:49][INFO][cartRetrieve]  Found an item
[2021/03/17 18:29:49][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 18:29:49][INFO][sendMovieRequest]  Building client...
[2021/03/17 18:29:49][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 18:29:49][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 18:29:49][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 18:29:49][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 18:29:49][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 18:29:49][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 18:29:53][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 18:29:53][INFO][orderPlace]  Query succeeded
[2021/03/17 18:29:53][INFO][orderPlace]  Found an sale_id: 54
[2021/03/17 18:29:53][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (54,54);
[2021/03/17 18:29:53][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 18:29:54][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:29:54][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:29:54][INFO][createPayPalOrder]  Order ID: 1UM083857P225004T
[2021/03/17 18:29:54][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:29:54][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (54,'1UM083857P225004T');
[2021/03/17 18:29:54][INFO][orderPlace]  Getting Order details
[2021/03/17 18:29:54][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:29:52Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1UM083857P225004T"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=1UM083857P225004T"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1UM083857P225004T"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1UM083857P225004T/capture"}],"id":"1UM083857P225004T","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:29:54][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=1UM083857P225004T
[2021/03/17 18:29:54][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 18:29:54][INFO][orderPlace]  Query succeeded
[2021/03/17 18:29:54][INFO][orderPlace]  Found an sale_id: 55
[2021/03/17 18:29:54][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (55,55);
[2021/03/17 18:29:54][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 18:29:55][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:29:55][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:29:55][INFO][createPayPalOrder]  Order ID: 9GY40068NE9118549
[2021/03/17 18:29:55][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:29:55][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (55,'9GY40068NE9118549');
[2021/03/17 18:29:55][INFO][orderPlace]  Getting Order details
[2021/03/17 18:29:55][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:29:53Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9GY40068NE9118549"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=9GY40068NE9118549"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9GY40068NE9118549"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9GY40068NE9118549/capture"}],"id":"9GY40068NE9118549","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:29:55][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=9GY40068NE9118549
[2021/03/17 18:32:16][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:32:16][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:32:16][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:32:16][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:32:16][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:32:16][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:32:16][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:32:16][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:38:56][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:38:56][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:38:56][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:38:56][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:38:56][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:38:56][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:38:56][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:38:56][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:38:57][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:38:57][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'petertheanteater@uci.edu'
[2021/03/17 18:38:57][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:38:57][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:38:57][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:38:57][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'petertheanteater@uci.edu'
[2021/03/17 18:38:57][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:38:57][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:39:22][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:39:22][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:39:22][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:39:22][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:39:22][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:39:22][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:39:22][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:39:22][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:41:22][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:41:22][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'petertheanteater@uci.edu'
[2021/03/17 18:41:22][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:41:22][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:41:22][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:41:22][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'petertheanteater@uci.edu'
[2021/03/17 18:41:22][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:41:22][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:41:22][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:41:22][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:41:22][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:41:22][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:41:22][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:41:22][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:41:22][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:41:22][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:41:43][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 18:41:43][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 18:41:43][INFO][sendIdmRequest]  Building client...
[2021/03/17 18:41:43][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 18:41:43][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 18:41:43][INFO][isAuthenticated]  Reading entity.
[2021/03/17 18:41:43][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 18:41:43][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu' AND cart.movie_id = 'tt4154756';
[2021/03/17 18:41:43][INFO][cartInsert]  Query succeeded
[2021/03/17 18:41:43][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('rememberme@uci.edu', 'tt4154756', 1);
[2021/03/17 18:41:43][INFO][cartInsert]  Update succeeded
[2021/03/17 18:41:43][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 18:41:43][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 18:41:43][INFO][sendIdmRequest]  Building client...
[2021/03/17 18:41:43][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 18:41:43][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 18:41:43][INFO][isAuthenticated]  Reading entity.
[2021/03/17 18:41:43][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 18:41:43][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu' AND cart.movie_id = 'tt4154756';
[2021/03/17 18:41:43][INFO][cartInsert]  Query succeeded
[2021/03/17 18:41:43][INFO][cartInsert]  Found a duplicate
[2021/03/17 18:41:48][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:41:48][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:41:48][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:41:48][INFO][cartRetrieve]  Found an item
[2021/03/17 18:41:48][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 18:41:48][INFO][sendMovieRequest]  Building client...
[2021/03/17 18:41:48][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 18:41:48][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 18:41:48][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 18:41:48][INFO][cartRetrieve]  Retrieving tt4154756
[2021/03/17 18:41:48][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154756';
[2021/03/17 18:41:48][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 18:41:48][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:41:48][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:41:48][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:41:48][INFO][cartRetrieve]  Found an item
[2021/03/17 18:41:48][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 18:41:48][INFO][sendMovieRequest]  Building client...
[2021/03/17 18:41:48][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 18:41:48][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 18:41:48][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 18:41:48][INFO][cartRetrieve]  Retrieving tt4154756
[2021/03/17 18:41:48][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154756';
[2021/03/17 18:41:48][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 18:41:51][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 18:41:51][INFO][orderPlace]  Query succeeded
[2021/03/17 18:41:51][INFO][orderPlace]  Found an sale_id: 56
[2021/03/17 18:41:51][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (56,56);
[2021/03/17 18:41:51][INFO][orderPlace]  Sum was 9.548000364795328
[2021/03/17 18:41:52][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:41:52][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:41:52][INFO][createPayPalOrder]  Order ID: 4651988527263344E
[2021/03/17 18:41:52][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:41:52][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (56,'4651988527263344E');
[2021/03/17 18:41:52][INFO][orderPlace]  Getting Order details
[2021/03/17 18:41:52][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:41:50Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.55","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/4651988527263344E"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=4651988527263344E"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/4651988527263344E"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/4651988527263344E/capture"}],"id":"4651988527263344E","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:41:52][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=4651988527263344E
[2021/03/17 18:41:52][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 18:41:52][INFO][orderPlace]  Query succeeded
[2021/03/17 18:41:52][INFO][orderPlace]  Found an sale_id: 57
[2021/03/17 18:41:52][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (57,57);
[2021/03/17 18:41:52][INFO][orderPlace]  Sum was 9.548000364795328
[2021/03/17 18:41:53][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:41:53][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:41:53][INFO][createPayPalOrder]  Order ID: 2FJ43145RP198492J
[2021/03/17 18:41:53][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:41:53][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (57,'2FJ43145RP198492J');
[2021/03/17 18:41:53][INFO][orderPlace]  Getting Order details
[2021/03/17 18:41:53][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:41:51Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.55","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/2FJ43145RP198492J"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=2FJ43145RP198492J"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/2FJ43145RP198492J"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/2FJ43145RP198492J/capture"}],"id":"2FJ43145RP198492J","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:41:53][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=2FJ43145RP198492J
[2021/03/17 18:42:07][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 18:42:09][INFO][captureOrder]  Capture ID: 5JG17692M3026263M
[2021/03/17 18:42:09][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '5JG17692M3026263M' WHERE token = '2FJ43145RP198492J';
[2021/03/17 18:42:09][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '2FJ43145RP198492J';
[2021/03/17 18:42:09][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 18:42:11][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 18:42:11][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"9ea4a410b7845","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 18:42:11][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '2FJ43145RP198492J';
[2021/03/17 18:42:11][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '2FJ43145RP198492J';
[2021/03/17 18:42:37][INFO][orderRetrieve]  Found token: 4651988527263344E
[2021/03/17 18:42:37][INFO][orderRetrieve]  Found token: 2FJ43145RP198492J
[2021/03/17 18:42:37][INFO][getOrderDetailed]  Full response body:{"create_time":"2021-03-18T01:41:50Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.55","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/4651988527263344E"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=4651988527263344E"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/4651988527263344E"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/4651988527263344E/capture"}],"id":"4651988527263344E","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:43:28][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 18:43:28][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 18:43:28][INFO][sendIdmRequest]  Building client...
[2021/03/17 18:43:28][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 18:43:28][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 18:43:28][INFO][isAuthenticated]  Reading entity.
[2021/03/17 18:43:28][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 18:43:28][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 18:43:28][INFO][cartInsert]  Query succeeded
[2021/03/17 18:43:28][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('rememberme@uci.edu', 'tt4154796', 1);
[2021/03/17 18:43:28][INFO][cartInsert]  Update succeeded
[2021/03/17 18:43:28][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 18:43:28][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 18:43:28][INFO][sendIdmRequest]  Building client...
[2021/03/17 18:43:28][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 18:43:28][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 18:43:28][INFO][isAuthenticated]  Reading entity.
[2021/03/17 18:43:28][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 18:43:28][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 18:43:28][INFO][cartInsert]  Query succeeded
[2021/03/17 18:43:28][INFO][cartInsert]  Found a duplicate
[2021/03/17 18:43:31][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:43:31][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:43:31][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:43:31][INFO][cartRetrieve]  Found an item
[2021/03/17 18:43:31][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 18:43:31][INFO][sendMovieRequest]  Building client...
[2021/03/17 18:43:31][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 18:43:31][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 18:43:31][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 18:43:31][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 18:43:31][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 18:43:31][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 18:43:31][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:43:31][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:43:31][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:43:31][INFO][cartRetrieve]  Found an item
[2021/03/17 18:43:31][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 18:43:31][INFO][sendMovieRequest]  Building client...
[2021/03/17 18:43:31][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 18:43:31][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 18:43:31][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 18:43:31][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 18:43:31][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 18:43:31][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 18:43:33][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 18:43:33][INFO][orderPlace]  Query succeeded
[2021/03/17 18:43:33][INFO][orderPlace]  Found an sale_id: 58
[2021/03/17 18:43:33][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (58,58);
[2021/03/17 18:43:33][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 18:43:34][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:43:34][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:43:34][INFO][createPayPalOrder]  Order ID: 89H65597R5744443W
[2021/03/17 18:43:34][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:43:34][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (58,'89H65597R5744443W');
[2021/03/17 18:43:34][INFO][orderPlace]  Getting Order details
[2021/03/17 18:43:34][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:43:32Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/89H65597R5744443W"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=89H65597R5744443W"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/89H65597R5744443W"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/89H65597R5744443W/capture"}],"id":"89H65597R5744443W","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:43:34][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=89H65597R5744443W
[2021/03/17 18:43:34][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 18:43:34][INFO][orderPlace]  Query succeeded
[2021/03/17 18:43:34][INFO][orderPlace]  Found an sale_id: 59
[2021/03/17 18:43:34][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (59,59);
[2021/03/17 18:43:34][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 18:43:35][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:43:35][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:43:35][INFO][createPayPalOrder]  Order ID: 92N109008U069551P
[2021/03/17 18:43:35][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:43:35][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (59,'92N109008U069551P');
[2021/03/17 18:43:35][INFO][orderPlace]  Getting Order details
[2021/03/17 18:43:36][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:43:33Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/92N109008U069551P"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=92N109008U069551P"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/92N109008U069551P"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/92N109008U069551P/capture"}],"id":"92N109008U069551P","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:43:36][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=92N109008U069551P
[2021/03/17 18:47:17][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:47:17][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:47:17][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:47:17][INFO][cartRetrieve]  Found an item
[2021/03/17 18:47:17][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 18:47:17][INFO][sendMovieRequest]  Building client...
[2021/03/17 18:47:17][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 18:47:17][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 18:47:17][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 18:47:17][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 18:47:17][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 18:47:17][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 18:47:17][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:47:17][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:47:17][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:47:17][INFO][cartRetrieve]  Found an item
[2021/03/17 18:47:17][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 18:47:17][INFO][sendMovieRequest]  Building client...
[2021/03/17 18:47:17][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 18:47:17][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 18:47:17][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 18:47:17][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 18:47:17][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 18:47:17][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 18:47:26][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 18:47:26][INFO][orderPlace]  Query succeeded
[2021/03/17 18:47:26][INFO][orderPlace]  Found an sale_id: 60
[2021/03/17 18:47:26][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (60,60);
[2021/03/17 18:47:26][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 18:47:27][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:47:27][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:47:27][INFO][createPayPalOrder]  Order ID: 9D765260XC761032F
[2021/03/17 18:47:27][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:47:27][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (60,'9D765260XC761032F');
[2021/03/17 18:47:27][INFO][orderPlace]  Getting Order details
[2021/03/17 18:47:27][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:47:25Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9D765260XC761032F"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=9D765260XC761032F"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9D765260XC761032F"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9D765260XC761032F/capture"}],"id":"9D765260XC761032F","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:47:27][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=9D765260XC761032F
[2021/03/17 18:47:27][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 18:47:27][INFO][orderPlace]  Query succeeded
[2021/03/17 18:47:27][INFO][orderPlace]  Found an sale_id: 61
[2021/03/17 18:47:27][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (61,61);
[2021/03/17 18:47:27][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 18:47:28][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:47:28][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:47:28][INFO][createPayPalOrder]  Order ID: 54P28150S6503680L
[2021/03/17 18:47:28][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:47:28][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (61,'54P28150S6503680L');
[2021/03/17 18:47:28][INFO][orderPlace]  Getting Order details
[2021/03/17 18:47:28][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:47:26Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/54P28150S6503680L"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=54P28150S6503680L"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/54P28150S6503680L"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/54P28150S6503680L/capture"}],"id":"54P28150S6503680L","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:47:28][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=54P28150S6503680L
[2021/03/17 18:55:38][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:55:38][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:55:38][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:55:38][INFO][cartRetrieve]  Found an item
[2021/03/17 18:55:38][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 18:55:38][INFO][sendMovieRequest]  Building client...
[2021/03/17 18:55:38][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 18:55:38][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 18:55:38][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 18:55:38][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 18:55:38][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 18:55:38][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 18:55:38][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:55:38][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:55:38][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:55:38][INFO][cartRetrieve]  Found an item
[2021/03/17 18:55:38][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 18:55:38][INFO][sendMovieRequest]  Building client...
[2021/03/17 18:55:38][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 18:55:38][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 18:55:38][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 18:55:38][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 18:55:38][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 18:55:38][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 18:55:40][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 18:55:40][INFO][orderPlace]  Query succeeded
[2021/03/17 18:55:40][INFO][orderPlace]  Found an sale_id: 62
[2021/03/17 18:55:40][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (62,62);
[2021/03/17 18:55:40][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 18:55:41][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:55:41][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:55:41][INFO][createPayPalOrder]  Order ID: 497201880M862815B
[2021/03/17 18:55:41][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:55:41][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (62,'497201880M862815B');
[2021/03/17 18:55:41][INFO][orderPlace]  Getting Order details
[2021/03/17 18:55:41][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:55:39Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/497201880M862815B"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=497201880M862815B"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/497201880M862815B"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/497201880M862815B/capture"}],"id":"497201880M862815B","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:55:41][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=497201880M862815B
[2021/03/17 18:55:41][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 18:55:41][INFO][orderPlace]  Query succeeded
[2021/03/17 18:55:41][INFO][orderPlace]  Found an sale_id: 63
[2021/03/17 18:55:41][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (63,63);
[2021/03/17 18:55:41][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 18:55:42][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:55:42][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:55:42][INFO][createPayPalOrder]  Order ID: 1TU67603DW3171037
[2021/03/17 18:55:42][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:55:42][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (63,'1TU67603DW3171037');
[2021/03/17 18:55:42][INFO][orderPlace]  Getting Order details
[2021/03/17 18:55:42][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:55:40Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1TU67603DW3171037"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=1TU67603DW3171037"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1TU67603DW3171037"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1TU67603DW3171037/capture"}],"id":"1TU67603DW3171037","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:55:42][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=1TU67603DW3171037
[2021/03/17 18:56:10][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 18:56:12][INFO][captureOrder]  Capture ID: 3VP00164FV761920X
[2021/03/17 18:56:12][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '3VP00164FV761920X' WHERE token = '1TU67603DW3171037';
[2021/03/17 18:56:12][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '1TU67603DW3171037';
[2021/03/17 18:56:12][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 18:56:13][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 18:56:13][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"a73e4ef1f9aaa","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 18:56:13][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '1TU67603DW3171037';
[2021/03/17 18:56:13][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '1TU67603DW3171037';
[2021/03/17 18:57:24][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:57:24][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:57:24][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:57:24][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:57:24][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:57:24][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:57:24][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:57:24][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 18:57:33][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 18:57:33][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 18:57:33][INFO][sendIdmRequest]  Building client...
[2021/03/17 18:57:33][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 18:57:33][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 18:57:33][INFO][isAuthenticated]  Reading entity.
[2021/03/17 18:57:33][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 18:57:33][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 18:57:33][INFO][cartInsert]  Query succeeded
[2021/03/17 18:57:33][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('rememberme@uci.edu', 'tt4154796', 2);
[2021/03/17 18:57:33][INFO][cartInsert]  Update succeeded
[2021/03/17 18:57:33][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 18:57:33][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 18:57:33][INFO][sendIdmRequest]  Building client...
[2021/03/17 18:57:33][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 18:57:33][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 18:57:33][INFO][isAuthenticated]  Reading entity.
[2021/03/17 18:57:33][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 18:57:33][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 18:57:33][INFO][cartInsert]  Query succeeded
[2021/03/17 18:57:33][INFO][cartInsert]  Found a duplicate
[2021/03/17 18:57:37][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:57:37][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:57:37][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:57:37][INFO][cartRetrieve]  Found an item
[2021/03/17 18:57:37][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 18:57:37][INFO][sendMovieRequest]  Building client...
[2021/03/17 18:57:37][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 18:57:37][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 18:57:37][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 18:57:37][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 18:57:37][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 18:57:37][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 18:57:37][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 18:57:37][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 18:57:37][INFO][cartRetrieve]  Query succeeded
[2021/03/17 18:57:37][INFO][cartRetrieve]  Found an item
[2021/03/17 18:57:37][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 18:57:37][INFO][sendMovieRequest]  Building client...
[2021/03/17 18:57:37][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 18:57:37][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 18:57:37][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 18:57:37][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 18:57:37][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 18:57:37][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 18:57:39][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 18:57:39][INFO][orderPlace]  Query succeeded
[2021/03/17 18:57:39][INFO][orderPlace]  Found an sale_id: 64
[2021/03/17 18:57:39][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (64,64);
[2021/03/17 18:57:39][INFO][orderPlace]  Sum was 19.496399659371377
[2021/03/17 18:57:40][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:57:40][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:57:40][INFO][createPayPalOrder]  Order ID: 00A9196609407051M
[2021/03/17 18:57:40][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:57:40][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (64,'00A9196609407051M');
[2021/03/17 18:57:40][INFO][orderPlace]  Getting Order details
[2021/03/17 18:57:40][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:57:38Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"19.50","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/00A9196609407051M"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=00A9196609407051M"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/00A9196609407051M"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/00A9196609407051M/capture"}],"id":"00A9196609407051M","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:57:40][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=00A9196609407051M
[2021/03/17 18:57:40][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 18:57:40][INFO][orderPlace]  Query succeeded
[2021/03/17 18:57:40][INFO][orderPlace]  Found an sale_id: 65
[2021/03/17 18:57:40][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (65,65);
[2021/03/17 18:57:40][INFO][orderPlace]  Sum was 19.496399659371377
[2021/03/17 18:57:41][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 18:57:41][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 18:57:41][INFO][createPayPalOrder]  Order ID: 36R131006N794073F
[2021/03/17 18:57:41][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 18:57:41][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (65,'36R131006N794073F');
[2021/03/17 18:57:41][INFO][orderPlace]  Getting Order details
[2021/03/17 18:57:41][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T01:57:39Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"19.50","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/36R131006N794073F"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=36R131006N794073F"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/36R131006N794073F"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/36R131006N794073F/capture"}],"id":"36R131006N794073F","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 18:57:41][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=36R131006N794073F
[2021/03/17 18:57:53][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 18:57:55][INFO][captureOrder]  Capture ID: 0MT19706E39367017
[2021/03/17 18:57:55][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '0MT19706E39367017' WHERE token = '36R131006N794073F';
[2021/03/17 18:57:55][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '36R131006N794073F';
[2021/03/17 18:57:55][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 18:57:57][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 18:57:57][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"38b65288d8265","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 18:57:57][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '36R131006N794073F';
[2021/03/17 18:57:57][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '36R131006N794073F';
[2021/03/17 19:00:45][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:00:45][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 19:00:45][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:00:45][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 19:00:45][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:00:45][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 19:00:45][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:00:45][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 19:00:52][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:00:52][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:00:52][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:00:52][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:00:52][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:00:52][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:00:52][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:00:52][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:00:52][INFO][cartInsert]  Query succeeded
[2021/03/17 19:00:52][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('rememberme@uci.edu', 'tt4154796', 2);
[2021/03/17 19:00:52][INFO][cartInsert]  Update succeeded
[2021/03/17 19:00:52][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:00:52][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:00:52][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:00:52][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:00:52][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:00:52][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:00:52][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:00:52][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:00:52][INFO][cartInsert]  Query succeeded
[2021/03/17 19:00:52][INFO][cartInsert]  Found a duplicate
[2021/03/17 19:00:55][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:00:55][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 19:00:55][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:00:55][INFO][cartRetrieve]  Found an item
[2021/03/17 19:00:55][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:00:55][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:00:55][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:00:55][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:00:55][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:00:55][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:00:55][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:00:55][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:00:55][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:00:55][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 19:00:55][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:00:55][INFO][cartRetrieve]  Found an item
[2021/03/17 19:00:55][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:00:55][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:00:55][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:00:55][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:00:55][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:00:55][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:00:55][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:00:55][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:00:58][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 19:00:58][INFO][orderPlace]  Query succeeded
[2021/03/17 19:00:58][INFO][orderPlace]  Found an sale_id: 66
[2021/03/17 19:00:58][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (66,66);
[2021/03/17 19:00:58][INFO][orderPlace]  Sum was 19.496399659371377
[2021/03/17 19:00:59][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:00:59][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:00:59][INFO][createPayPalOrder]  Order ID: 41N46507133518543
[2021/03/17 19:00:59][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:00:59][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (66,'41N46507133518543');
[2021/03/17 19:00:59][INFO][orderPlace]  Getting Order details
[2021/03/17 19:00:59][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:00:57Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"19.50","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/41N46507133518543"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=41N46507133518543"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/41N46507133518543"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/41N46507133518543/capture"}],"id":"41N46507133518543","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:00:59][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=41N46507133518543
[2021/03/17 19:00:59][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 19:00:59][INFO][orderPlace]  Query succeeded
[2021/03/17 19:00:59][INFO][orderPlace]  Found an sale_id: 67
[2021/03/17 19:00:59][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (67,67);
[2021/03/17 19:00:59][INFO][orderPlace]  Sum was 19.496399659371377
[2021/03/17 19:01:00][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:01:00][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:01:00][INFO][createPayPalOrder]  Order ID: 7GM53880MP4409915
[2021/03/17 19:01:00][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:01:00][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (67,'7GM53880MP4409915');
[2021/03/17 19:01:00][INFO][orderPlace]  Getting Order details
[2021/03/17 19:01:00][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:00:58Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"19.50","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7GM53880MP4409915"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=7GM53880MP4409915"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7GM53880MP4409915"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7GM53880MP4409915/capture"}],"id":"7GM53880MP4409915","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:01:00][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=7GM53880MP4409915
[2021/03/17 19:02:17][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:02:19][INFO][captureOrder]  Capture ID: 55J36247JB808702Y
[2021/03/17 19:02:19][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '55J36247JB808702Y' WHERE token = '7GM53880MP4409915';
[2021/03/17 19:02:19][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '7GM53880MP4409915';
[2021/03/17 19:02:19][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:02:20][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 19:02:20][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"c39dc7548ea9b","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 19:02:20][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '7GM53880MP4409915';
[2021/03/17 19:02:20][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '7GM53880MP4409915';
[2021/03/17 19:04:02][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:04:02][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:04:02][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:04:02][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:04:02][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:04:02][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:04:02][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:04:02][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:04:02][INFO][cartInsert]  Query succeeded
[2021/03/17 19:04:02][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('rememberme@uci.edu', 'tt4154796', 1);
[2021/03/17 19:04:02][INFO][cartInsert]  Update succeeded
[2021/03/17 19:04:02][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:04:02][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:04:02][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:04:02][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:04:02][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:04:02][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:04:02][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:04:02][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:04:02][INFO][cartInsert]  Query succeeded
[2021/03/17 19:04:02][INFO][cartInsert]  Found a duplicate
[2021/03/17 19:04:57][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:04:57][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 19:04:57][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:04:57][INFO][cartRetrieve]  Found an item
[2021/03/17 19:04:57][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:04:57][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:04:57][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:04:57][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:04:57][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:04:57][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:04:57][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:04:57][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:04:57][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:04:57][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 19:04:57][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:04:57][INFO][cartRetrieve]  Found an item
[2021/03/17 19:04:57][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:04:57][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:04:57][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:04:57][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:04:57][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:04:57][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:04:57][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:04:57][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:05:01][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 19:05:01][INFO][orderPlace]  Query succeeded
[2021/03/17 19:05:01][INFO][orderPlace]  Found an sale_id: 68
[2021/03/17 19:05:01][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (68,68);
[2021/03/17 19:05:01][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 19:05:02][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:05:02][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:05:02][INFO][createPayPalOrder]  Order ID: 45S20238674320222
[2021/03/17 19:05:02][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:05:02][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (68,'45S20238674320222');
[2021/03/17 19:05:02][INFO][orderPlace]  Getting Order details
[2021/03/17 19:05:02][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:05:00Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/45S20238674320222"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=45S20238674320222"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/45S20238674320222"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/45S20238674320222/capture"}],"id":"45S20238674320222","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:05:02][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=45S20238674320222
[2021/03/17 19:05:02][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 19:05:02][INFO][orderPlace]  Query succeeded
[2021/03/17 19:05:02][INFO][orderPlace]  Found an sale_id: 69
[2021/03/17 19:05:02][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (69,69);
[2021/03/17 19:05:02][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 19:05:03][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:05:03][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:05:03][INFO][createPayPalOrder]  Order ID: 6DB83827EX2654925
[2021/03/17 19:05:03][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:05:03][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (69,'6DB83827EX2654925');
[2021/03/17 19:05:03][INFO][orderPlace]  Getting Order details
[2021/03/17 19:05:03][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:05:01Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6DB83827EX2654925"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=6DB83827EX2654925"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6DB83827EX2654925"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6DB83827EX2654925/capture"}],"id":"6DB83827EX2654925","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:05:03][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=6DB83827EX2654925
[2021/03/17 19:05:39][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:05:39][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 19:05:39][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:05:39][INFO][cartRetrieve]  Found an item
[2021/03/17 19:05:39][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:05:39][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:05:39][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:05:39][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:05:39][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:05:39][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:05:39][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:05:39][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:05:39][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:05:39][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 19:05:39][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:05:39][INFO][cartRetrieve]  Found an item
[2021/03/17 19:05:39][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:05:39][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:05:39][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:05:39][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:05:39][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:05:39][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:05:39][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:05:39][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:05:45][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 19:05:45][INFO][orderPlace]  Query succeeded
[2021/03/17 19:05:45][INFO][orderPlace]  Found an sale_id: 70
[2021/03/17 19:05:45][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (70,70);
[2021/03/17 19:05:45][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 19:05:46][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:05:46][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:05:46][INFO][createPayPalOrder]  Order ID: 9JP01441YC4214445
[2021/03/17 19:05:46][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:05:46][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (70,'9JP01441YC4214445');
[2021/03/17 19:05:46][INFO][orderPlace]  Getting Order details
[2021/03/17 19:05:46][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:05:43Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9JP01441YC4214445"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=9JP01441YC4214445"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9JP01441YC4214445"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9JP01441YC4214445/capture"}],"id":"9JP01441YC4214445","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:05:46][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=9JP01441YC4214445
[2021/03/17 19:05:46][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 19:05:46][INFO][orderPlace]  Query succeeded
[2021/03/17 19:05:46][INFO][orderPlace]  Found an sale_id: 71
[2021/03/17 19:05:46][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (71,71);
[2021/03/17 19:05:46][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 19:05:47][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:05:47][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:05:47][INFO][createPayPalOrder]  Order ID: 8C326359SG4438735
[2021/03/17 19:05:47][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:05:47][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (71,'8C326359SG4438735');
[2021/03/17 19:05:47][INFO][orderPlace]  Getting Order details
[2021/03/17 19:05:47][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:05:45Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/8C326359SG4438735"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=8C326359SG4438735"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/8C326359SG4438735"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/8C326359SG4438735/capture"}],"id":"8C326359SG4438735","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:05:47][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=8C326359SG4438735
[2021/03/17 19:06:50][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:06:50][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:06:50][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:06:50][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:06:50][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:06:50][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:06:50][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:06:50][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'peteranteater@uci.edu' AND cart.movie_id = 'tt0308514';
[2021/03/17 19:06:50][INFO][cartInsert]  Query succeeded
[2021/03/17 19:06:50][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('peteranteater@uci.edu', 'tt0308514', 2);
[2021/03/17 19:06:50][INFO][cartInsert]  Update succeeded
[2021/03/17 19:06:53][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'peteranteater@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'peteranteater@uci.edu';
[2021/03/17 19:06:53][INFO][orderPlace]  Query succeeded
[2021/03/17 19:06:53][INFO][orderPlace]  Found an sale_id: 72
[2021/03/17 19:06:53][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (72,72);
[2021/03/17 19:06:53][INFO][orderPlace]  Sum was 20.914800911140446
[2021/03/17 19:06:54][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:06:54][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:06:54][INFO][createPayPalOrder]  Order ID: 87362644DJ1306604
[2021/03/17 19:06:54][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:06:54][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (72,'87362644DJ1306604');
[2021/03/17 19:06:54][INFO][orderPlace]  Getting Order details
[2021/03/17 19:06:54][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:06:51Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"20.91","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/87362644DJ1306604"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=87362644DJ1306604"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/87362644DJ1306604"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/87362644DJ1306604/capture"}],"id":"87362644DJ1306604","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:06:54][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=87362644DJ1306604
[2021/03/17 19:08:08][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:08:08][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 19:08:08][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:08:08][INFO][cartRetrieve]  Found an item
[2021/03/17 19:08:08][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:08:08][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:08:08][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:08:08][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:08:08][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:08:08][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:08:08][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:08:08][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:08:08][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:08:08][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 19:08:08][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:08:08][INFO][cartRetrieve]  Found an item
[2021/03/17 19:08:08][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:08:08][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:08:08][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:08:08][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:08:08][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:08:08][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:08:08][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:08:08][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:08:11][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 19:08:11][INFO][orderPlace]  Query succeeded
[2021/03/17 19:08:11][INFO][orderPlace]  Found an sale_id: 73
[2021/03/17 19:08:11][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (73,73);
[2021/03/17 19:08:11][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 19:08:12][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:08:12][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:08:12][INFO][createPayPalOrder]  Order ID: 95463973H4978091H
[2021/03/17 19:08:12][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:08:12][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (73,'95463973H4978091H');
[2021/03/17 19:08:12][INFO][orderPlace]  Getting Order details
[2021/03/17 19:08:12][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:08:10Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/95463973H4978091H"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=95463973H4978091H"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/95463973H4978091H"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/95463973H4978091H/capture"}],"id":"95463973H4978091H","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:08:12][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=95463973H4978091H
[2021/03/17 19:08:12][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'rememberme@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'rememberme@uci.edu';
[2021/03/17 19:08:12][INFO][orderPlace]  Query succeeded
[2021/03/17 19:08:12][INFO][orderPlace]  Found an sale_id: 74
[2021/03/17 19:08:12][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (74,74);
[2021/03/17 19:08:12][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 19:08:14][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:08:14][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:08:14][INFO][createPayPalOrder]  Order ID: 0FR66253G4670394A
[2021/03/17 19:08:14][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:08:14][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (74,'0FR66253G4670394A');
[2021/03/17 19:08:14][INFO][orderPlace]  Getting Order details
[2021/03/17 19:08:14][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:08:11Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/0FR66253G4670394A"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=0FR66253G4670394A"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/0FR66253G4670394A"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/0FR66253G4670394A/capture"}],"id":"0FR66253G4670394A","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:08:14][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=0FR66253G4670394A
[2021/03/17 19:12:28][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:12:28][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:12:28][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:12:28][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 19:12:28][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:12:28][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:12:28][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:12:28][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 19:12:48][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:12:48][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:12:48][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:12:48][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:12:48][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:12:48][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:12:48][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:12:48][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:12:48][INFO][cartInsert]  Query succeeded
[2021/03/17 19:12:48][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('newaccount@uci.edu', 'tt4154796', 2);
[2021/03/17 19:12:48][INFO][cartInsert]  Update succeeded
[2021/03/17 19:12:48][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:12:48][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:12:48][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:12:48][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:12:48][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:12:48][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:12:48][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:12:48][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:12:48][INFO][cartInsert]  Query succeeded
[2021/03/17 19:12:48][INFO][cartInsert]  Found a duplicate
[2021/03/17 19:12:51][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:12:51][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:12:51][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:12:51][INFO][cartRetrieve]  Found an item
[2021/03/17 19:12:51][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:12:51][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:12:51][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:12:51][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:12:51][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:12:51][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:12:51][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:12:51][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:12:51][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:12:51][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:12:51][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:12:51][INFO][cartRetrieve]  Found an item
[2021/03/17 19:12:51][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:12:51][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:12:51][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:12:51][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:12:51][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:12:51][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:12:51][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:12:51][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:13:10][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'newaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'newaccount@uci.edu';
[2021/03/17 19:13:10][INFO][orderPlace]  Query succeeded
[2021/03/17 19:13:10][INFO][orderPlace]  Found an sale_id: 75
[2021/03/17 19:13:10][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (75,75);
[2021/03/17 19:13:10][INFO][orderPlace]  Sum was 19.496399659371377
[2021/03/17 19:13:11][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:13:11][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:13:11][INFO][createPayPalOrder]  Order ID: 1VR945220M7512748
[2021/03/17 19:13:11][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:13:11][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (75,'1VR945220M7512748');
[2021/03/17 19:13:11][INFO][orderPlace]  Getting Order details
[2021/03/17 19:13:11][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:13:09Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"19.50","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1VR945220M7512748"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=1VR945220M7512748"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1VR945220M7512748"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1VR945220M7512748/capture"}],"id":"1VR945220M7512748","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:13:11][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=1VR945220M7512748
[2021/03/17 19:13:11][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'newaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'newaccount@uci.edu';
[2021/03/17 19:13:11][INFO][orderPlace]  Query succeeded
[2021/03/17 19:13:11][INFO][orderPlace]  Found an sale_id: 76
[2021/03/17 19:13:11][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (76,76);
[2021/03/17 19:13:11][INFO][orderPlace]  Sum was 19.496399659371377
[2021/03/17 19:13:12][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:13:12][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:13:12][INFO][createPayPalOrder]  Order ID: 6H209024N15466436
[2021/03/17 19:13:12][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:13:12][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (76,'6H209024N15466436');
[2021/03/17 19:13:12][INFO][orderPlace]  Getting Order details
[2021/03/17 19:13:13][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:13:10Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"19.50","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6H209024N15466436"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=6H209024N15466436"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6H209024N15466436"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6H209024N15466436/capture"}],"id":"6H209024N15466436","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:13:13][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=6H209024N15466436
[2021/03/17 19:13:43][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:13:45][INFO][captureOrder]  Capture ID: 21V767815S948583G
[2021/03/17 19:13:45][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '21V767815S948583G' WHERE token = '6H209024N15466436';
[2021/03/17 19:13:45][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '6H209024N15466436';
[2021/03/17 19:13:45][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:13:46][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 19:13:46][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"6e3c70fd6e763","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 19:13:46][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '6H209024N15466436';
[2021/03/17 19:13:46][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '6H209024N15466436';
[2021/03/17 19:14:16][INFO][orderRetrieve]  Found token: 6H209024N15466436
[2021/03/17 19:14:16][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T02:13:42Z","create_time":"2021-03-18T02:13:10Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"19.50","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"19.50","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T02:13:42Z","create_time":"2021-03-18T02:13:42Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"0.87","currency_code":"USD"},"gross_amount":{"value":"19.50","currency_code":"USD"},"net_amount":{"value":"18.63","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/21V767815S948583G"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/21V767815S948583G/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6H209024N15466436"}],"id":"21V767815S948583G","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6H209024N15466436"}],"id":"6H209024N15466436","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 19:16:35][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:16:35][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:16:35][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:16:35][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:16:35][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:16:35][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:16:35][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:16:35][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu' AND cart.movie_id = 'tt4154756';
[2021/03/17 19:16:35][INFO][cartInsert]  Query succeeded
[2021/03/17 19:16:35][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('newaccount@uci.edu', 'tt4154756', 1);
[2021/03/17 19:16:35][INFO][cartInsert]  Update succeeded
[2021/03/17 19:16:35][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:16:35][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:16:35][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:16:35][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:16:35][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:16:35][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:16:35][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:16:35][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu' AND cart.movie_id = 'tt4154756';
[2021/03/17 19:16:35][INFO][cartInsert]  Query succeeded
[2021/03/17 19:16:35][INFO][cartInsert]  Found a duplicate
[2021/03/17 19:16:38][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:16:38][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:16:38][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:16:38][INFO][cartRetrieve]  Found an item
[2021/03/17 19:16:38][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:16:38][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:16:38][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:16:38][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:16:38][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:16:38][INFO][cartRetrieve]  Retrieving tt4154756
[2021/03/17 19:16:38][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154756';
[2021/03/17 19:16:38][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:16:38][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:16:38][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:16:38][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:16:38][INFO][cartRetrieve]  Found an item
[2021/03/17 19:16:38][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:16:38][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:16:38][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:16:38][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:16:38][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:16:38][INFO][cartRetrieve]  Retrieving tt4154756
[2021/03/17 19:16:38][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154756';
[2021/03/17 19:16:38][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:16:42][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'newaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'newaccount@uci.edu';
[2021/03/17 19:16:42][INFO][orderPlace]  Query succeeded
[2021/03/17 19:16:42][INFO][orderPlace]  Found an sale_id: 77
[2021/03/17 19:16:42][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (77,77);
[2021/03/17 19:16:42][INFO][orderPlace]  Sum was 9.548000364795328
[2021/03/17 19:16:43][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:16:43][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:16:43][INFO][createPayPalOrder]  Order ID: 1C865637V38263535
[2021/03/17 19:16:43][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:16:43][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (77,'1C865637V38263535');
[2021/03/17 19:16:43][INFO][orderPlace]  Getting Order details
[2021/03/17 19:16:43][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:16:40Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.55","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1C865637V38263535"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=1C865637V38263535"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1C865637V38263535"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1C865637V38263535/capture"}],"id":"1C865637V38263535","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:16:43][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=1C865637V38263535
[2021/03/17 19:16:43][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'newaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'newaccount@uci.edu';
[2021/03/17 19:16:43][INFO][orderPlace]  Query succeeded
[2021/03/17 19:16:43][INFO][orderPlace]  Found an sale_id: 78
[2021/03/17 19:16:43][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (78,78);
[2021/03/17 19:16:43][INFO][orderPlace]  Sum was 9.548000364795328
[2021/03/17 19:16:44][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:16:44][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:16:44][INFO][createPayPalOrder]  Order ID: 6WD13858WR058994F
[2021/03/17 19:16:44][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:16:44][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (78,'6WD13858WR058994F');
[2021/03/17 19:16:44][INFO][orderPlace]  Getting Order details
[2021/03/17 19:16:44][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:16:42Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.55","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6WD13858WR058994F"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=6WD13858WR058994F"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6WD13858WR058994F"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/6WD13858WR058994F/capture"}],"id":"6WD13858WR058994F","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:16:44][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=6WD13858WR058994F
[2021/03/17 19:25:18][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:25:18][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:25:18][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:25:18][INFO][cartRetrieve]  Found an item
[2021/03/17 19:25:18][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:25:18][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:25:18][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:25:18][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:25:18][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:25:18][INFO][cartRetrieve]  Retrieving tt4154756
[2021/03/17 19:25:18][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154756';
[2021/03/17 19:25:18][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:25:18][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:25:18][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:25:18][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:25:18][INFO][cartRetrieve]  Found an item
[2021/03/17 19:25:18][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:25:18][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:25:18][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:25:19][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:25:19][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:25:19][INFO][cartRetrieve]  Retrieving tt4154756
[2021/03/17 19:25:19][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154756';
[2021/03/17 19:25:19][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:25:22][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'newaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'newaccount@uci.edu';
[2021/03/17 19:25:22][INFO][orderPlace]  Query succeeded
[2021/03/17 19:25:22][INFO][orderPlace]  Found an sale_id: 79
[2021/03/17 19:25:22][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (79,79);
[2021/03/17 19:25:22][INFO][orderPlace]  Sum was 9.548000364795328
[2021/03/17 19:25:23][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:25:23][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:25:23][INFO][createPayPalOrder]  Order ID: 0Y971371RT5775738
[2021/03/17 19:25:23][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:25:23][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (79,'0Y971371RT5775738');
[2021/03/17 19:25:23][INFO][orderPlace]  Getting Order details
[2021/03/17 19:25:23][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:25:21Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.55","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/0Y971371RT5775738"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=0Y971371RT5775738"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/0Y971371RT5775738"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/0Y971371RT5775738/capture"}],"id":"0Y971371RT5775738","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:25:23][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=0Y971371RT5775738
[2021/03/17 19:25:23][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'newaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'newaccount@uci.edu';
[2021/03/17 19:25:23][INFO][orderPlace]  Query succeeded
[2021/03/17 19:25:23][INFO][orderPlace]  Found an sale_id: 80
[2021/03/17 19:25:23][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (80,80);
[2021/03/17 19:25:23][INFO][orderPlace]  Sum was 9.548000364795328
[2021/03/17 19:25:24][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:25:24][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:25:24][INFO][createPayPalOrder]  Order ID: 2P764912UW592193T
[2021/03/17 19:25:24][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:25:24][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (80,'2P764912UW592193T');
[2021/03/17 19:25:24][INFO][orderPlace]  Getting Order details
[2021/03/17 19:25:24][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:25:22Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.55","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/2P764912UW592193T"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=2P764912UW592193T"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/2P764912UW592193T"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/2P764912UW592193T/capture"}],"id":"2P764912UW592193T","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:25:24][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=2P764912UW592193T
[2021/03/17 19:25:59][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:26:00][INFO][captureOrder]  Capture ID: 90R68556LX231064J
[2021/03/17 19:26:00][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '90R68556LX231064J' WHERE token = '2P764912UW592193T';
[2021/03/17 19:26:00][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '2P764912UW592193T';
[2021/03/17 19:26:00][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:26:02][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 19:26:02][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"d99e518f771a7","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 19:26:02][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '2P764912UW592193T';
[2021/03/17 19:26:02][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '2P764912UW592193T';
[2021/03/17 19:26:14][INFO][orderRetrieve]  Found token: 0Y971371RT5775738
[2021/03/17 19:26:14][INFO][getOrderDetailed]  Full response body:{"create_time":"2021-03-18T02:25:21Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.55","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/0Y971371RT5775738"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=0Y971371RT5775738"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/0Y971371RT5775738"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/0Y971371RT5775738/capture"}],"id":"0Y971371RT5775738","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:26:27][INFO][orderRetrieve]  Found token: 0Y971371RT5775738
[2021/03/17 19:26:27][INFO][getOrderDetailed]  Full response body:{"create_time":"2021-03-18T02:25:21Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.55","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/0Y971371RT5775738"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=0Y971371RT5775738"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/0Y971371RT5775738"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/0Y971371RT5775738/capture"}],"id":"0Y971371RT5775738","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:27:04][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:27:04][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:27:04][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:27:04][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:27:04][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:27:04][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:27:04][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:27:04][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:27:04][INFO][cartInsert]  Query succeeded
[2021/03/17 19:27:04][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('newaccount@uci.edu', 'tt4154796', 1);
[2021/03/17 19:27:04][INFO][cartInsert]  Update succeeded
[2021/03/17 19:27:04][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:27:04][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:27:04][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:27:04][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:27:04][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:27:04][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:27:04][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:27:04][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:27:04][INFO][cartInsert]  Query succeeded
[2021/03/17 19:27:04][INFO][cartInsert]  Found a duplicate
[2021/03/17 19:27:07][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:27:07][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:27:07][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:27:07][INFO][cartRetrieve]  Found an item
[2021/03/17 19:27:07][INFO][cartRetrieve]  Found an item
[2021/03/17 19:27:07][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:27:07][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:27:07][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:27:07][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:27:07][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:27:07][INFO][cartRetrieve]  Retrieving tt4154756
[2021/03/17 19:27:07][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154756';
[2021/03/17 19:27:07][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:27:07][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:27:07][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:27:07][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:27:07][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:27:07][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:27:07][INFO][cartRetrieve]  Found an item
[2021/03/17 19:27:07][INFO][cartRetrieve]  Found an item
[2021/03/17 19:27:07][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:27:07][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:27:07][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:27:07][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:27:07][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:27:07][INFO][cartRetrieve]  Retrieving tt4154756
[2021/03/17 19:27:07][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154756';
[2021/03/17 19:27:07][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:27:07][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:27:07][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:27:15][INFO][cartDelete]  Received a POST /cart/delete request.
[2021/03/17 19:27:15][INFO][cartDelete]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu' AND cart.movie_id = 'tt4154756';
[2021/03/17 19:27:15][INFO][cartDelete]  Query succeeded
[2021/03/17 19:27:15][INFO][cartDelete]  Found a match
[2021/03/17 19:27:15][INFO][cartDelete]  Found an existing pair, preparing delete
[2021/03/17 19:27:15][INFO][cartDelete]  Delete succeeded
[2021/03/17 19:27:15][INFO][cartDelete]  Received a POST /cart/delete request.
[2021/03/17 19:27:15][INFO][cartDelete]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu' AND cart.movie_id = 'tt4154756';
[2021/03/17 19:27:15][INFO][cartDelete]  Query succeeded
[2021/03/17 19:27:15][INFO][cartDelete]  No pair found, ending Delete operation
[2021/03/17 19:27:16][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:27:16][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:27:16][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:27:16][INFO][cartRetrieve]  Found an item
[2021/03/17 19:27:16][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:27:16][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:27:16][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:27:16][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:27:16][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:27:16][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:27:16][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:27:16][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:27:16][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:27:16][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:27:16][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:27:16][INFO][cartRetrieve]  Found an item
[2021/03/17 19:27:16][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:27:16][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:27:16][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:27:16][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:27:16][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:27:16][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:27:16][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:27:16][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:27:37][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'newaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'newaccount@uci.edu';
[2021/03/17 19:27:37][INFO][orderPlace]  Query succeeded
[2021/03/17 19:27:37][INFO][orderPlace]  Found an sale_id: 81
[2021/03/17 19:27:37][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (81,81);
[2021/03/17 19:27:37][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 19:27:37][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:27:37][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:27:37][INFO][createPayPalOrder]  Order ID: 1X163796RU120271F
[2021/03/17 19:27:37][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:27:37][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (81,'1X163796RU120271F');
[2021/03/17 19:27:37][INFO][orderPlace]  Getting Order details
[2021/03/17 19:27:38][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:27:35Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1X163796RU120271F"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=1X163796RU120271F"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1X163796RU120271F"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1X163796RU120271F/capture"}],"id":"1X163796RU120271F","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:27:38][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=1X163796RU120271F
[2021/03/17 19:27:38][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'newaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'newaccount@uci.edu';
[2021/03/17 19:27:38][INFO][orderPlace]  Query succeeded
[2021/03/17 19:27:38][INFO][orderPlace]  Found an sale_id: 82
[2021/03/17 19:27:38][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (82,82);
[2021/03/17 19:27:38][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 19:27:39][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:27:39][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:27:39][INFO][createPayPalOrder]  Order ID: 1P591179U7464500A
[2021/03/17 19:27:39][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:27:39][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (82,'1P591179U7464500A');
[2021/03/17 19:27:39][INFO][orderPlace]  Getting Order details
[2021/03/17 19:27:39][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:27:36Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1P591179U7464500A"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=1P591179U7464500A"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1P591179U7464500A"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1P591179U7464500A/capture"}],"id":"1P591179U7464500A","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:27:39][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=1P591179U7464500A
[2021/03/17 19:28:05][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:28:07][INFO][captureOrder]  Capture ID: 9HH8610437305993D
[2021/03/17 19:28:07][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '9HH8610437305993D' WHERE token = '1P591179U7464500A';
[2021/03/17 19:28:07][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '1P591179U7464500A';
[2021/03/17 19:28:07][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:28:08][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 19:28:08][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"9bb4bc8d2df4d","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 19:28:08][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '1P591179U7464500A';
[2021/03/17 19:28:08][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '1P591179U7464500A';
[2021/03/17 19:28:18][INFO][orderRetrieve]  Found token: 1P591179U7464500A
[2021/03/17 19:28:19][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T02:28:04Z","create_time":"2021-03-18T02:27:36Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"9.75","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T02:28:04Z","create_time":"2021-03-18T02:28:04Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"0.58","currency_code":"USD"},"gross_amount":{"value":"9.75","currency_code":"USD"},"net_amount":{"value":"9.17","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/9HH8610437305993D"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/9HH8610437305993D/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1P591179U7464500A"}],"id":"9HH8610437305993D","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1P591179U7464500A"}],"id":"1P591179U7464500A","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 19:28:43][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:28:43][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:28:43][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:28:43][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:28:43][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:28:43][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:28:43][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:28:43][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:28:43][INFO][cartInsert]  Query succeeded
[2021/03/17 19:28:43][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('newaccount@uci.edu', 'tt4154796', 1);
[2021/03/17 19:28:43][INFO][cartInsert]  Update succeeded
[2021/03/17 19:28:43][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:28:43][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:28:43][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:28:43][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:28:43][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:28:43][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:28:43][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:28:43][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:28:43][INFO][cartInsert]  Query succeeded
[2021/03/17 19:28:43][INFO][cartInsert]  Found a duplicate
[2021/03/17 19:28:47][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:28:47][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:28:47][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:28:47][INFO][cartRetrieve]  Found an item
[2021/03/17 19:28:47][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:28:47][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:28:47][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:28:47][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:28:47][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:28:47][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:28:47][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:28:47][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:28:47][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:28:47][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:28:47][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:28:47][INFO][cartRetrieve]  Found an item
[2021/03/17 19:28:47][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:28:47][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:28:47][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:28:47][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:28:47][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:28:47][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:28:47][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:28:47][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:29:23][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:29:23][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:29:23][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:29:23][INFO][cartRetrieve]  Found an item
[2021/03/17 19:29:23][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:29:23][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:29:23][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:29:23][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:29:23][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:29:23][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:29:23][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:29:23][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:29:23][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:29:23][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:29:23][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:29:23][INFO][cartRetrieve]  Found an item
[2021/03/17 19:29:23][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:29:23][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:29:23][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:29:23][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:29:23][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:29:23][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:29:23][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:29:23][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:29:40][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'newaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'newaccount@uci.edu';
[2021/03/17 19:29:40][INFO][orderPlace]  Query succeeded
[2021/03/17 19:29:40][INFO][orderPlace]  Found an sale_id: 83
[2021/03/17 19:29:40][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (83,83);
[2021/03/17 19:29:40][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 19:29:41][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:29:41][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:29:41][INFO][createPayPalOrder]  Order ID: 7XX16588AJ187403D
[2021/03/17 19:29:41][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:29:41][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (83,'7XX16588AJ187403D');
[2021/03/17 19:29:41][INFO][orderPlace]  Getting Order details
[2021/03/17 19:29:42][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:29:39Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7XX16588AJ187403D"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=7XX16588AJ187403D"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7XX16588AJ187403D"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7XX16588AJ187403D/capture"}],"id":"7XX16588AJ187403D","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:29:42][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=7XX16588AJ187403D
[2021/03/17 19:29:42][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'newaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'newaccount@uci.edu';
[2021/03/17 19:29:42][INFO][orderPlace]  Query succeeded
[2021/03/17 19:29:42][INFO][orderPlace]  Found an sale_id: 84
[2021/03/17 19:29:42][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (84,84);
[2021/03/17 19:29:42][INFO][orderPlace]  Sum was 9.748199829685689
[2021/03/17 19:29:43][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:29:43][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:29:43][INFO][createPayPalOrder]  Order ID: 1DE653993J595370P
[2021/03/17 19:29:43][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:29:43][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (84,'1DE653993J595370P');
[2021/03/17 19:29:43][INFO][orderPlace]  Getting Order details
[2021/03/17 19:29:43][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:29:41Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1DE653993J595370P"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=1DE653993J595370P"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1DE653993J595370P"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1DE653993J595370P/capture"}],"id":"1DE653993J595370P","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:29:43][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=1DE653993J595370P
[2021/03/17 19:30:07][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:30:09][INFO][captureOrder]  Capture ID: 5NX68709XS811690F
[2021/03/17 19:30:09][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '5NX68709XS811690F' WHERE token = '1DE653993J595370P';
[2021/03/17 19:30:09][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '1DE653993J595370P';
[2021/03/17 19:30:09][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:30:10][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 19:30:10][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"b6be8e0a1ff25","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 19:30:10][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '1DE653993J595370P';
[2021/03/17 19:30:10][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '1DE653993J595370P';
[2021/03/17 19:30:17][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:30:17][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:30:17][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:30:17][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 19:30:17][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:30:17][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'newaccount@uci.edu'
[2021/03/17 19:30:17][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:30:17][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 19:30:23][INFO][orderRetrieve]  Found token: 1DE653993J595370P
[2021/03/17 19:30:23][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T02:30:06Z","create_time":"2021-03-18T02:29:41Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"9.75","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T02:30:06Z","create_time":"2021-03-18T02:30:06Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"0.58","currency_code":"USD"},"gross_amount":{"value":"9.75","currency_code":"USD"},"net_amount":{"value":"9.17","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/5NX68709XS811690F"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/5NX68709XS811690F/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1DE653993J595370P"}],"id":"5NX68709XS811690F","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1DE653993J595370P"}],"id":"1DE653993J595370P","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 19:43:03][INFO][orderRetrieve]  Found token: 1DE653993J595370P
[2021/03/17 19:43:04][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T02:30:06Z","create_time":"2021-03-18T02:29:41Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"9.75","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T02:30:06Z","create_time":"2021-03-18T02:30:06Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"0.58","currency_code":"USD"},"gross_amount":{"value":"9.75","currency_code":"USD"},"net_amount":{"value":"9.17","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/5NX68709XS811690F"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/5NX68709XS811690F/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1DE653993J595370P"}],"id":"5NX68709XS811690F","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1DE653993J595370P"}],"id":"1DE653993J595370P","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 19:43:04][INFO][orderRetrieve]  Found token: 1DE653993J595370P
[2021/03/17 19:43:04][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T02:30:06Z","create_time":"2021-03-18T02:29:41Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"9.75","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"9.75","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T02:30:06Z","create_time":"2021-03-18T02:30:06Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"0.58","currency_code":"USD"},"gross_amount":{"value":"9.75","currency_code":"USD"},"net_amount":{"value":"9.17","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/5NX68709XS811690F"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/5NX68709XS811690F/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1DE653993J595370P"}],"id":"5NX68709XS811690F","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1DE653993J595370P"}],"id":"1DE653993J595370P","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 19:43:31][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:43:31][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 19:43:31][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:43:31][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 19:43:31][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:43:31][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'rememberme@uci.edu'
[2021/03/17 19:43:31][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:43:31][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 19:47:07][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:47:07][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:47:07][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:47:07][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 19:47:07][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:47:07][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:47:07][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:47:07][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 19:48:06][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:48:06][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:48:06][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:48:06][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:48:06][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:48:06][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:48:06][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:48:06][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 19:48:06][INFO][cartInsert]  Query succeeded
[2021/03/17 19:48:06][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('somerandomaccount@uci.edu', 'tt1345836', 3);
[2021/03/17 19:48:06][INFO][cartInsert]  Update succeeded
[2021/03/17 19:48:06][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:48:06][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:48:06][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:48:06][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:48:06][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:48:06][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:48:06][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:48:06][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 19:48:06][INFO][cartInsert]  Query succeeded
[2021/03/17 19:48:06][INFO][cartInsert]  Found a duplicate
[2021/03/17 19:48:46][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:48:46][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:48:46][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:48:46][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:48:46][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:48:46][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:48:46][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:48:46][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:48:46][INFO][cartInsert]  Query succeeded
[2021/03/17 19:48:46][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('somerandomaccount@uci.edu', 'tt4154796', 10);
[2021/03/17 19:48:46][INFO][cartInsert]  Update succeeded
[2021/03/17 19:48:46][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:48:46][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:48:46][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:48:46][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:48:46][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:48:46][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:48:46][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:48:46][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:48:46][INFO][cartInsert]  Query succeeded
[2021/03/17 19:48:46][INFO][cartInsert]  Found a duplicate
[2021/03/17 19:48:52][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:48:52][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:48:52][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:48:52][INFO][cartRetrieve]  Found an item
[2021/03/17 19:48:52][INFO][cartRetrieve]  Found an item
[2021/03/17 19:48:52][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:48:52][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:48:52][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:48:52][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:48:52][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:48:52][INFO][cartRetrieve]  Retrieving tt1345836
[2021/03/17 19:48:52][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt1345836';
[2021/03/17 19:48:52][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:48:52][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:48:52][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:48:52][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:48:52][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:48:52][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:48:52][INFO][cartRetrieve]  Found an item
[2021/03/17 19:48:52][INFO][cartRetrieve]  Found an item
[2021/03/17 19:48:52][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:48:52][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:48:52][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:48:52][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:48:52][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:48:52][INFO][cartRetrieve]  Retrieving tt1345836
[2021/03/17 19:48:52][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt1345836';
[2021/03/17 19:48:52][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:48:52][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:48:52][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:49:00][INFO][cartDelete]  Received a POST /cart/delete request.
[2021/03/17 19:49:00][INFO][cartDelete]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 19:49:00][INFO][cartDelete]  Query succeeded
[2021/03/17 19:49:00][INFO][cartDelete]  Found a match
[2021/03/17 19:49:00][INFO][cartDelete]  Found an existing pair, preparing delete
[2021/03/17 19:49:00][INFO][cartDelete]  Delete succeeded
[2021/03/17 19:49:00][INFO][cartDelete]  Received a POST /cart/delete request.
[2021/03/17 19:49:00][INFO][cartDelete]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 19:49:00][INFO][cartDelete]  Query succeeded
[2021/03/17 19:49:00][INFO][cartDelete]  No pair found, ending Delete operation
[2021/03/17 19:49:01][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:49:01][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:49:01][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:49:01][INFO][cartRetrieve]  Found an item
[2021/03/17 19:49:01][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:49:01][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:49:01][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:49:01][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:49:01][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:49:01][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:49:01][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:49:01][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:49:01][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:49:01][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:49:01][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:49:01][INFO][cartRetrieve]  Found an item
[2021/03/17 19:49:01][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:49:01][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:49:01][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:49:01][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:49:01][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:49:01][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:49:01][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:49:01][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:49:15][INFO][cartUpdate]  Received a POST /cart/update request.
[2021/03/17 19:49:15][INFO][cartUpdate]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:49:15][INFO][cartUpdate]  Query succeeded
[2021/03/17 19:49:15][INFO][cartUpdate]  Found a match
[2021/03/17 19:49:15][INFO][cartUpdate]  Found an existing pair, preparing update
[2021/03/17 19:49:15][INFO][cartUpdate]  Update succeeded
[2021/03/17 19:49:15][INFO][cartUpdate]  Received a POST /cart/update request.
[2021/03/17 19:49:15][INFO][cartUpdate]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:49:15][INFO][cartUpdate]  Query succeeded
[2021/03/17 19:49:15][INFO][cartUpdate]  Found a match
[2021/03/17 19:49:15][INFO][cartUpdate]  Found an existing pair, preparing update
[2021/03/17 19:49:15][INFO][cartUpdate]  Update succeeded
[2021/03/17 19:49:16][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:49:16][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:49:16][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:49:16][INFO][cartRetrieve]  Found an item
[2021/03/17 19:49:16][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:49:16][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:49:16][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:49:16][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:49:16][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:49:16][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:49:16][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:49:16][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:49:16][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:49:16][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:49:16][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:49:16][INFO][cartRetrieve]  Found an item
[2021/03/17 19:49:16][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:49:16][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:49:16][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:49:16][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:49:16][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:49:16][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:49:16][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:49:16][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:49:26][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'somerandomaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'somerandomaccount@uci.edu';
[2021/03/17 19:49:26][INFO][orderPlace]  Query succeeded
[2021/03/17 19:49:26][INFO][orderPlace]  Found an sale_id: 85
[2021/03/17 19:49:26][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (85,85);
[2021/03/17 19:49:26][INFO][orderPlace]  Sum was 194.96399659371377
[2021/03/17 19:49:26][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:49:26][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:49:26][INFO][createPayPalOrder]  Order ID: 9K2301238Y331581A
[2021/03/17 19:49:26][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:49:26][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (85,'9K2301238Y331581A');
[2021/03/17 19:49:26][INFO][orderPlace]  Getting Order details
[2021/03/17 19:49:27][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:49:24Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9K2301238Y331581A"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=9K2301238Y331581A"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9K2301238Y331581A"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9K2301238Y331581A/capture"}],"id":"9K2301238Y331581A","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:49:27][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=9K2301238Y331581A
[2021/03/17 19:49:27][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'somerandomaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'somerandomaccount@uci.edu';
[2021/03/17 19:49:27][INFO][orderPlace]  Query succeeded
[2021/03/17 19:49:27][INFO][orderPlace]  Found an sale_id: 86
[2021/03/17 19:49:27][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (86,86);
[2021/03/17 19:49:27][INFO][orderPlace]  Sum was 194.96399659371377
[2021/03/17 19:49:28][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:49:28][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:49:28][INFO][createPayPalOrder]  Order ID: 93U683411V139834C
[2021/03/17 19:49:28][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:49:28][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (86,'93U683411V139834C');
[2021/03/17 19:49:28][INFO][orderPlace]  Getting Order details
[2021/03/17 19:49:28][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:49:25Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/93U683411V139834C"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=93U683411V139834C"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/93U683411V139834C"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/93U683411V139834C/capture"}],"id":"93U683411V139834C","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:49:28][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=93U683411V139834C
[2021/03/17 19:50:35][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:50:37][INFO][captureOrder]  Capture ID: 7TN66008YJ3730940
[2021/03/17 19:50:37][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '7TN66008YJ3730940' WHERE token = '93U683411V139834C';
[2021/03/17 19:50:37][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '93U683411V139834C';
[2021/03/17 19:50:37][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:50:39][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 19:50:39][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"2d4e22bf21f9c","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 19:50:39][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '93U683411V139834C';
[2021/03/17 19:50:39][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '93U683411V139834C';
[2021/03/17 19:50:54][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:50:54][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:50:54][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:50:54][INFO][cartRetrieve]  Found an item
[2021/03/17 19:50:54][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:50:54][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:50:54][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:50:54][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:50:54][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:50:54][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:50:54][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:50:54][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:50:54][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:50:54][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:50:54][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:50:54][INFO][cartRetrieve]  Found an item
[2021/03/17 19:50:54][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:50:54][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:50:54][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:50:54][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:50:54][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:50:54][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 19:50:54][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 19:50:54][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:51:04][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'somerandomaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'somerandomaccount@uci.edu';
[2021/03/17 19:51:04][INFO][orderPlace]  Query succeeded
[2021/03/17 19:51:04][INFO][orderPlace]  Found an sale_id: 87
[2021/03/17 19:51:04][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (87,87);
[2021/03/17 19:51:04][INFO][orderPlace]  Sum was 194.96399659371377
[2021/03/17 19:51:05][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:51:05][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:51:05][INFO][createPayPalOrder]  Order ID: 3P20005515992683T
[2021/03/17 19:51:05][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:51:05][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (87,'3P20005515992683T');
[2021/03/17 19:51:05][INFO][orderPlace]  Getting Order details
[2021/03/17 19:51:06][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:51:03Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/3P20005515992683T"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=3P20005515992683T"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/3P20005515992683T"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/3P20005515992683T/capture"}],"id":"3P20005515992683T","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:51:06][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=3P20005515992683T
[2021/03/17 19:51:06][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'somerandomaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'somerandomaccount@uci.edu';
[2021/03/17 19:51:06][INFO][orderPlace]  Query succeeded
[2021/03/17 19:51:06][INFO][orderPlace]  Found an sale_id: 88
[2021/03/17 19:51:06][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (88,88);
[2021/03/17 19:51:06][INFO][orderPlace]  Sum was 194.96399659371377
[2021/03/17 19:51:07][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:51:07][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:51:07][INFO][createPayPalOrder]  Order ID: 7BJ18873TN6128429
[2021/03/17 19:51:07][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:51:07][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (88,'7BJ18873TN6128429');
[2021/03/17 19:51:07][INFO][orderPlace]  Getting Order details
[2021/03/17 19:51:07][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:51:05Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7BJ18873TN6128429"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=7BJ18873TN6128429"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7BJ18873TN6128429"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7BJ18873TN6128429/capture"}],"id":"7BJ18873TN6128429","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:51:07][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=7BJ18873TN6128429
[2021/03/17 19:51:32][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:51:34][INFO][captureOrder]  Capture ID: 2WP8270084982920J
[2021/03/17 19:51:34][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '2WP8270084982920J' WHERE token = '7BJ18873TN6128429';
[2021/03/17 19:51:34][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '7BJ18873TN6128429';
[2021/03/17 19:51:34][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:51:35][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 19:51:35][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"9f3ce16987f70","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 19:51:35][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '7BJ18873TN6128429';
[2021/03/17 19:51:35][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '7BJ18873TN6128429';
[2021/03/17 19:51:37][INFO][orderRetrieve]  Found token: 7BJ18873TN6128429
[2021/03/17 19:51:37][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T02:51:31Z","create_time":"2021-03-18T02:51:05Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"194.96","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T02:51:31Z","create_time":"2021-03-18T02:51:31Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"5.95","currency_code":"USD"},"gross_amount":{"value":"194.96","currency_code":"USD"},"net_amount":{"value":"189.01","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/2WP8270084982920J"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/2WP8270084982920J/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7BJ18873TN6128429"}],"id":"2WP8270084982920J","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7BJ18873TN6128429"}],"id":"7BJ18873TN6128429","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 19:51:37][INFO][orderRetrieve]  Found token: 7BJ18873TN6128429
[2021/03/17 19:51:38][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T02:51:31Z","create_time":"2021-03-18T02:51:05Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"194.96","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T02:51:31Z","create_time":"2021-03-18T02:51:31Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"5.95","currency_code":"USD"},"gross_amount":{"value":"194.96","currency_code":"USD"},"net_amount":{"value":"189.01","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/2WP8270084982920J"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/2WP8270084982920J/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7BJ18873TN6128429"}],"id":"2WP8270084982920J","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/7BJ18873TN6128429"}],"id":"7BJ18873TN6128429","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 19:53:34][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:53:34][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:53:34][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:53:34][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 19:53:34][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:53:34][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:53:34][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:53:34][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 19:53:42][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:53:42][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:53:42][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:53:42][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:53:42][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:53:42][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:53:42][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:53:42][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu' AND cart.movie_id = 'tt4154756';
[2021/03/17 19:53:42][INFO][cartInsert]  Query succeeded
[2021/03/17 19:53:42][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('somerandomaccount@uci.edu', 'tt4154756', 10);
[2021/03/17 19:53:42][INFO][cartInsert]  Update succeeded
[2021/03/17 19:53:42][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:53:42][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:53:42][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:53:42][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:53:42][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:53:42][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:53:42][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:53:42][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu' AND cart.movie_id = 'tt4154756';
[2021/03/17 19:53:42][INFO][cartInsert]  Query succeeded
[2021/03/17 19:53:42][INFO][cartInsert]  Found a duplicate
[2021/03/17 19:53:47][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:53:47][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:53:47][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:53:47][INFO][cartRetrieve]  Found an item
[2021/03/17 19:53:47][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:53:47][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:53:47][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:53:47][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:53:47][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:53:47][INFO][cartRetrieve]  Retrieving tt4154756
[2021/03/17 19:53:47][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154756';
[2021/03/17 19:53:47][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:53:47][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 19:53:47][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'somerandomaccount@uci.edu'
[2021/03/17 19:53:47][INFO][cartRetrieve]  Query succeeded
[2021/03/17 19:53:47][INFO][cartRetrieve]  Found an item
[2021/03/17 19:53:47][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 19:53:47][INFO][sendMovieRequest]  Building client...
[2021/03/17 19:53:47][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 19:53:47][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 19:53:47][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 19:53:47][INFO][cartRetrieve]  Retrieving tt4154756
[2021/03/17 19:53:47][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154756';
[2021/03/17 19:53:47][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 19:53:57][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'somerandomaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'somerandomaccount@uci.edu';
[2021/03/17 19:53:57][INFO][orderPlace]  Query succeeded
[2021/03/17 19:53:57][INFO][orderPlace]  Found an sale_id: 89
[2021/03/17 19:53:57][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (89,89);
[2021/03/17 19:53:57][INFO][orderPlace]  Sum was 95.48000364795328
[2021/03/17 19:53:58][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:53:58][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:53:58][INFO][createPayPalOrder]  Order ID: 70Y648928A464713C
[2021/03/17 19:53:58][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:53:58][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (89,'70Y648928A464713C');
[2021/03/17 19:53:58][INFO][orderPlace]  Getting Order details
[2021/03/17 19:53:58][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:53:55Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"95.48","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/70Y648928A464713C"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=70Y648928A464713C"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/70Y648928A464713C"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/70Y648928A464713C/capture"}],"id":"70Y648928A464713C","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:53:58][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=70Y648928A464713C
[2021/03/17 19:53:58][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'somerandomaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'somerandomaccount@uci.edu';
[2021/03/17 19:53:58][INFO][orderPlace]  Query succeeded
[2021/03/17 19:53:58][INFO][orderPlace]  Found an sale_id: 90
[2021/03/17 19:53:58][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (90,90);
[2021/03/17 19:53:58][INFO][orderPlace]  Sum was 95.48000364795328
[2021/03/17 19:53:59][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 19:53:59][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 19:53:59][INFO][createPayPalOrder]  Order ID: 9BY30450G6190953Y
[2021/03/17 19:53:59][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 19:53:59][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (90,'9BY30450G6190953Y');
[2021/03/17 19:53:59][INFO][orderPlace]  Getting Order details
[2021/03/17 19:53:59][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T02:53:57Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"95.48","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9BY30450G6190953Y"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=9BY30450G6190953Y"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9BY30450G6190953Y"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9BY30450G6190953Y/capture"}],"id":"9BY30450G6190953Y","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 19:53:59][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=9BY30450G6190953Y
[2021/03/17 19:54:40][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:54:42][INFO][captureOrder]  Capture ID: 6TY8107932396092L
[2021/03/17 19:54:42][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '6TY8107932396092L' WHERE token = '9BY30450G6190953Y';
[2021/03/17 19:54:42][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '9BY30450G6190953Y';
[2021/03/17 19:54:42][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 19:54:44][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 19:54:44][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"7e19d8ad1262f","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 19:54:44][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '9BY30450G6190953Y';
[2021/03/17 19:54:44][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '9BY30450G6190953Y';
[2021/03/17 19:54:45][INFO][orderRetrieve]  Found token: 7BJ18873TN6128429
[2021/03/17 19:54:45][INFO][orderRetrieve]  Found token: 9BY30450G6190953Y
[2021/03/17 19:54:46][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T02:54:39Z","create_time":"2021-03-18T02:53:57Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"95.48","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"95.48","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T02:54:39Z","create_time":"2021-03-18T02:54:39Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"3.07","currency_code":"USD"},"gross_amount":{"value":"95.48","currency_code":"USD"},"net_amount":{"value":"92.41","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/6TY8107932396092L"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/6TY8107932396092L/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9BY30450G6190953Y"}],"id":"6TY8107932396092L","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9BY30450G6190953Y"}],"id":"9BY30450G6190953Y","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 19:54:46][INFO][orderRetrieve]  Found token: 7BJ18873TN6128429
[2021/03/17 19:54:46][INFO][orderRetrieve]  Found token: 9BY30450G6190953Y
[2021/03/17 19:54:46][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T02:54:39Z","create_time":"2021-03-18T02:53:57Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"95.48","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"95.48","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T02:54:39Z","create_time":"2021-03-18T02:54:39Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"3.07","currency_code":"USD"},"gross_amount":{"value":"95.48","currency_code":"USD"},"net_amount":{"value":"92.41","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/6TY8107932396092L"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/6TY8107932396092L/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9BY30450G6190953Y"}],"id":"6TY8107932396092L","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9BY30450G6190953Y"}],"id":"9BY30450G6190953Y","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 19:54:51][INFO][orderRetrieve]  Found token: 7BJ18873TN6128429
[2021/03/17 19:54:51][INFO][orderRetrieve]  Found token: 9BY30450G6190953Y
[2021/03/17 19:54:52][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T02:54:39Z","create_time":"2021-03-18T02:53:57Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"95.48","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"95.48","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T02:54:39Z","create_time":"2021-03-18T02:54:39Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"3.07","currency_code":"USD"},"gross_amount":{"value":"95.48","currency_code":"USD"},"net_amount":{"value":"92.41","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/6TY8107932396092L"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/6TY8107932396092L/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9BY30450G6190953Y"}],"id":"6TY8107932396092L","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9BY30450G6190953Y"}],"id":"9BY30450G6190953Y","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 19:54:52][INFO][orderRetrieve]  Found token: 7BJ18873TN6128429
[2021/03/17 19:54:52][INFO][orderRetrieve]  Found token: 9BY30450G6190953Y
[2021/03/17 19:54:52][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T02:54:39Z","create_time":"2021-03-18T02:53:57Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"95.48","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"95.48","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T02:54:39Z","create_time":"2021-03-18T02:54:39Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"3.07","currency_code":"USD"},"gross_amount":{"value":"95.48","currency_code":"USD"},"net_amount":{"value":"92.41","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/6TY8107932396092L"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/6TY8107932396092L/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9BY30450G6190953Y"}],"id":"6TY8107932396092L","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/9BY30450G6190953Y"}],"id":"9BY30450G6190953Y","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 19:59:04][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:59:04][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:59:04][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:59:04][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:59:04][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:59:04][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:59:04][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:59:04][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'anewuser@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 19:59:04][INFO][cartInsert]  Query succeeded
[2021/03/17 19:59:04][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('anewuser@uci.edu', 'tt1345836', 3);
[2021/03/17 19:59:04][INFO][cartInsert]  Update succeeded
[2021/03/17 19:59:04][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:59:04][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:59:04][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:59:04][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:59:04][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:59:04][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:59:04][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:59:04][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'anewuser@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 19:59:04][INFO][cartInsert]  Query succeeded
[2021/03/17 19:59:04][INFO][cartInsert]  Found a duplicate
[2021/03/17 19:59:46][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:59:46][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:59:46][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:59:46][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:59:46][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:59:46][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:59:46][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:59:46][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'anewuser@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:59:46][INFO][cartInsert]  Query succeeded
[2021/03/17 19:59:46][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('anewuser@uci.edu', 'tt4154796', 10);
[2021/03/17 19:59:46][INFO][cartInsert]  Update succeeded
[2021/03/17 19:59:46][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 19:59:46][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 19:59:46][INFO][sendIdmRequest]  Building client...
[2021/03/17 19:59:46][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 19:59:46][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 19:59:46][INFO][isAuthenticated]  Reading entity.
[2021/03/17 19:59:46][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 19:59:46][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'anewuser@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 19:59:46][INFO][cartInsert]  Query succeeded
[2021/03/17 19:59:46][INFO][cartInsert]  Found a duplicate
[2021/03/17 20:02:29][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:02:29][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu'
[2021/03/17 20:02:29][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:02:29][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 20:02:29][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:02:29][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu'
[2021/03/17 20:02:29][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:02:29][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 20:03:19][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 20:03:19][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 20:03:19][INFO][sendIdmRequest]  Building client...
[2021/03/17 20:03:19][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 20:03:19][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 20:03:19][INFO][isAuthenticated]  Reading entity.
[2021/03/17 20:03:19][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 20:03:19][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 20:03:19][INFO][cartInsert]  Query succeeded
[2021/03/17 20:03:19][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('fefinalaccount@uci.edu', 'tt1345836', 3);
[2021/03/17 20:03:19][INFO][cartInsert]  Update succeeded
[2021/03/17 20:03:19][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 20:03:19][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 20:03:19][INFO][sendIdmRequest]  Building client...
[2021/03/17 20:03:19][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 20:03:19][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 20:03:19][INFO][isAuthenticated]  Reading entity.
[2021/03/17 20:03:19][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 20:03:19][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 20:03:19][INFO][cartInsert]  Query succeeded
[2021/03/17 20:03:19][INFO][cartInsert]  Found a duplicate
[2021/03/17 20:04:04][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 20:04:04][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 20:04:04][INFO][sendIdmRequest]  Building client...
[2021/03/17 20:04:04][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 20:04:04][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 20:04:04][INFO][isAuthenticated]  Reading entity.
[2021/03/17 20:04:04][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 20:04:04][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 20:04:04][INFO][cartInsert]  Query succeeded
[2021/03/17 20:04:04][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('fefinalaccount@uci.edu', 'tt4154796', 10);
[2021/03/17 20:04:04][INFO][cartInsert]  Update succeeded
[2021/03/17 20:04:04][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 20:04:04][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 20:04:04][INFO][sendIdmRequest]  Building client...
[2021/03/17 20:04:04][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 20:04:04][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 20:04:04][INFO][isAuthenticated]  Reading entity.
[2021/03/17 20:04:04][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 20:04:04][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 20:04:04][INFO][cartInsert]  Query succeeded
[2021/03/17 20:04:04][INFO][cartInsert]  Found a duplicate
[2021/03/17 20:04:09][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:04:09][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu'
[2021/03/17 20:04:09][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:04:09][INFO][cartRetrieve]  Found an item
[2021/03/17 20:04:09][INFO][cartRetrieve]  Found an item
[2021/03/17 20:04:09][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 20:04:09][INFO][sendMovieRequest]  Building client...
[2021/03/17 20:04:09][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 20:04:09][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 20:04:09][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 20:04:09][INFO][cartRetrieve]  Retrieving tt1345836
[2021/03/17 20:04:09][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt1345836';
[2021/03/17 20:04:09][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 20:04:09][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 20:04:09][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 20:04:09][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:04:09][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu'
[2021/03/17 20:04:09][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:04:09][INFO][cartRetrieve]  Found an item
[2021/03/17 20:04:09][INFO][cartRetrieve]  Found an item
[2021/03/17 20:04:09][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 20:04:09][INFO][sendMovieRequest]  Building client...
[2021/03/17 20:04:09][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 20:04:09][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 20:04:09][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 20:04:09][INFO][cartRetrieve]  Retrieving tt1345836
[2021/03/17 20:04:09][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt1345836';
[2021/03/17 20:04:09][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 20:04:09][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 20:04:09][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 20:04:15][INFO][cartDelete]  Received a POST /cart/delete request.
[2021/03/17 20:04:15][INFO][cartDelete]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 20:04:15][INFO][cartDelete]  Query succeeded
[2021/03/17 20:04:15][INFO][cartDelete]  Found a match
[2021/03/17 20:04:15][INFO][cartDelete]  Found an existing pair, preparing delete
[2021/03/17 20:04:15][INFO][cartDelete]  Delete succeeded
[2021/03/17 20:04:15][INFO][cartDelete]  Received a POST /cart/delete request.
[2021/03/17 20:04:15][INFO][cartDelete]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 20:04:15][INFO][cartDelete]  Query succeeded
[2021/03/17 20:04:15][INFO][cartDelete]  No pair found, ending Delete operation
[2021/03/17 20:04:16][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:04:16][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu'
[2021/03/17 20:04:16][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:04:16][INFO][cartRetrieve]  Found an item
[2021/03/17 20:04:16][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 20:04:16][INFO][sendMovieRequest]  Building client...
[2021/03/17 20:04:16][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 20:04:16][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 20:04:16][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 20:04:16][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 20:04:16][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 20:04:16][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 20:04:16][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:04:16][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu'
[2021/03/17 20:04:16][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:04:16][INFO][cartRetrieve]  Found an item
[2021/03/17 20:04:16][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 20:04:16][INFO][sendMovieRequest]  Building client...
[2021/03/17 20:04:16][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 20:04:16][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 20:04:16][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 20:04:16][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 20:04:16][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 20:04:16][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 20:04:21][INFO][cartUpdate]  Received a POST /cart/update request.
[2021/03/17 20:04:21][INFO][cartUpdate]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 20:04:21][INFO][cartUpdate]  Query succeeded
[2021/03/17 20:04:21][INFO][cartUpdate]  Found a match
[2021/03/17 20:04:21][INFO][cartUpdate]  Found an existing pair, preparing update
[2021/03/17 20:04:21][INFO][cartUpdate]  Update succeeded
[2021/03/17 20:04:21][INFO][cartUpdate]  Received a POST /cart/update request.
[2021/03/17 20:04:21][INFO][cartUpdate]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 20:04:21][INFO][cartUpdate]  Query succeeded
[2021/03/17 20:04:21][INFO][cartUpdate]  Found a match
[2021/03/17 20:04:21][INFO][cartUpdate]  Found an existing pair, preparing update
[2021/03/17 20:04:21][INFO][cartUpdate]  Update succeeded
[2021/03/17 20:04:22][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:04:22][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu'
[2021/03/17 20:04:22][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:04:22][INFO][cartRetrieve]  Found an item
[2021/03/17 20:04:22][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 20:04:22][INFO][sendMovieRequest]  Building client...
[2021/03/17 20:04:22][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 20:04:22][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 20:04:22][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 20:04:22][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 20:04:22][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 20:04:22][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 20:04:22][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:04:22][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'fefinalaccount@uci.edu'
[2021/03/17 20:04:22][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:04:22][INFO][cartRetrieve]  Found an item
[2021/03/17 20:04:22][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 20:04:22][INFO][sendMovieRequest]  Building client...
[2021/03/17 20:04:22][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 20:04:22][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 20:04:22][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 20:04:22][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 20:04:22][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 20:04:22][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 20:04:32][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'fefinalaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'fefinalaccount@uci.edu';
[2021/03/17 20:04:32][INFO][orderPlace]  Query succeeded
[2021/03/17 20:04:32][INFO][orderPlace]  Found an sale_id: 91
[2021/03/17 20:04:32][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (91,91);
[2021/03/17 20:04:32][INFO][orderPlace]  Sum was 194.96399659371377
[2021/03/17 20:04:33][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 20:04:33][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 20:04:33][INFO][createPayPalOrder]  Order ID: 1GR98808YM293021D
[2021/03/17 20:04:33][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 20:04:33][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (91,'1GR98808YM293021D');
[2021/03/17 20:04:33][INFO][orderPlace]  Getting Order details
[2021/03/17 20:04:34][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T03:04:31Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1GR98808YM293021D"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=1GR98808YM293021D"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1GR98808YM293021D"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/1GR98808YM293021D/capture"}],"id":"1GR98808YM293021D","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 20:04:34][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=1GR98808YM293021D
[2021/03/17 20:04:34][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'fefinalaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'fefinalaccount@uci.edu';
[2021/03/17 20:04:34][INFO][orderPlace]  Query succeeded
[2021/03/17 20:04:34][INFO][orderPlace]  Found an sale_id: 92
[2021/03/17 20:04:34][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (92,92);
[2021/03/17 20:04:34][INFO][orderPlace]  Sum was 194.96399659371377
[2021/03/17 20:04:35][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 20:04:35][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 20:04:35][INFO][createPayPalOrder]  Order ID: 44C12759AS500105F
[2021/03/17 20:04:35][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 20:04:35][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (92,'44C12759AS500105F');
[2021/03/17 20:04:35][INFO][orderPlace]  Getting Order details
[2021/03/17 20:04:35][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T03:04:32Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/44C12759AS500105F"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=44C12759AS500105F"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/44C12759AS500105F"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/44C12759AS500105F/capture"}],"id":"44C12759AS500105F","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 20:04:35][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=44C12759AS500105F
[2021/03/17 20:05:04][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 20:05:06][INFO][captureOrder]  Capture ID: 4XD00007VN6703333
[2021/03/17 20:05:06][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '4XD00007VN6703333' WHERE token = '44C12759AS500105F';
[2021/03/17 20:05:06][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '44C12759AS500105F';
[2021/03/17 20:05:06][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 20:05:07][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 20:05:07][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"f79e32203dfbf","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 20:05:07][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '44C12759AS500105F';
[2021/03/17 20:05:07][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '44C12759AS500105F';
[2021/03/17 20:05:13][INFO][orderRetrieve]  Found token: 44C12759AS500105F
[2021/03/17 20:05:14][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T03:05:03Z","create_time":"2021-03-18T03:04:32Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"194.96","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T03:05:03Z","create_time":"2021-03-18T03:05:03Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"5.95","currency_code":"USD"},"gross_amount":{"value":"194.96","currency_code":"USD"},"net_amount":{"value":"189.01","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/4XD00007VN6703333"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/4XD00007VN6703333/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/44C12759AS500105F"}],"id":"4XD00007VN6703333","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/44C12759AS500105F"}],"id":"44C12759AS500105F","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 20:05:14][INFO][orderRetrieve]  Found token: 44C12759AS500105F
[2021/03/17 20:05:14][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T03:05:03Z","create_time":"2021-03-18T03:04:32Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"194.96","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T03:05:03Z","create_time":"2021-03-18T03:05:03Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"5.95","currency_code":"USD"},"gross_amount":{"value":"194.96","currency_code":"USD"},"net_amount":{"value":"189.01","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/4XD00007VN6703333"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/4XD00007VN6703333/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/44C12759AS500105F"}],"id":"4XD00007VN6703333","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/44C12759AS500105F"}],"id":"44C12759AS500105F","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 20:12:13][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:12:13][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu'
[2021/03/17 20:12:13][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:12:13][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 20:12:13][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:12:13][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu'
[2021/03/17 20:12:13][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:12:13][INFO][cartRetrieve]  No cart found, ending Retrieve operation
[2021/03/17 20:13:14][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 20:13:14][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 20:13:14][INFO][sendIdmRequest]  Building client...
[2021/03/17 20:13:14][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 20:13:14][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 20:13:14][INFO][isAuthenticated]  Reading entity.
[2021/03/17 20:13:14][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 20:13:14][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 20:13:14][INFO][cartInsert]  Query succeeded
[2021/03/17 20:13:14][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('finalaccount@uci.edu', 'tt1345836', 3);
[2021/03/17 20:13:14][INFO][cartInsert]  Update succeeded
[2021/03/17 20:13:14][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 20:13:14][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 20:13:14][INFO][sendIdmRequest]  Building client...
[2021/03/17 20:13:14][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 20:13:14][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 20:13:14][INFO][isAuthenticated]  Reading entity.
[2021/03/17 20:13:14][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 20:13:14][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 20:13:14][INFO][cartInsert]  Query succeeded
[2021/03/17 20:13:14][INFO][cartInsert]  Found a duplicate
[2021/03/17 20:14:01][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 20:14:01][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 20:14:01][INFO][sendIdmRequest]  Building client...
[2021/03/17 20:14:01][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 20:14:01][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 20:14:01][INFO][isAuthenticated]  Reading entity.
[2021/03/17 20:14:01][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 20:14:01][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 20:14:01][INFO][cartInsert]  Query succeeded
[2021/03/17 20:14:01][INFO][cartInsert]  Running insertQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO cart (cart.email, cart.movie_id, cart.quantity)
VALUES ('finalaccount@uci.edu', 'tt4154796', 10);
[2021/03/17 20:14:01][INFO][cartInsert]  Update succeeded
[2021/03/17 20:14:01][INFO][cartInsert]  Received a POST /cart/insert request.
[2021/03/17 20:14:01][INFO][sendIdmRequest]  Preparing remote request to Idm endpoint /privilege.
[2021/03/17 20:14:01][INFO][sendIdmRequest]  Building client...
[2021/03/17 20:14:01][INFO][sendIdmRequest]  Building WebTarget...
[2021/03/17 20:14:01][INFO][sendIdmRequest]  Sending remote request.
[2021/03/17 20:14:01][INFO][isAuthenticated]  Reading entity.
[2021/03/17 20:14:01][INFO][isAuthenticated]  Remote replied with code 141.
[2021/03/17 20:14:01][INFO][cartInsert]  Running checkDuplicate SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 20:14:01][INFO][cartInsert]  Query succeeded
[2021/03/17 20:14:01][INFO][cartInsert]  Found a duplicate
[2021/03/17 20:14:06][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:14:06][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu'
[2021/03/17 20:14:06][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:14:06][INFO][cartRetrieve]  Found an item
[2021/03/17 20:14:06][INFO][cartRetrieve]  Found an item
[2021/03/17 20:14:06][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 20:14:06][INFO][sendMovieRequest]  Building client...
[2021/03/17 20:14:06][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 20:14:06][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 20:14:06][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 20:14:06][INFO][cartRetrieve]  Retrieving tt1345836
[2021/03/17 20:14:06][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt1345836';
[2021/03/17 20:14:06][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 20:14:06][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 20:14:06][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 20:14:06][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:14:06][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu'
[2021/03/17 20:14:06][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:14:06][INFO][cartRetrieve]  Found an item
[2021/03/17 20:14:06][INFO][cartRetrieve]  Found an item
[2021/03/17 20:14:06][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 20:14:06][INFO][sendMovieRequest]  Building client...
[2021/03/17 20:14:06][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 20:14:06][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 20:14:06][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 20:14:06][INFO][cartRetrieve]  Retrieving tt1345836
[2021/03/17 20:14:06][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt1345836';
[2021/03/17 20:14:06][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 20:14:06][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 20:14:06][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 20:14:12][INFO][cartDelete]  Received a POST /cart/delete request.
[2021/03/17 20:14:12][INFO][cartDelete]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 20:14:12][INFO][cartDelete]  Query succeeded
[2021/03/17 20:14:12][INFO][cartDelete]  Found a match
[2021/03/17 20:14:12][INFO][cartDelete]  Found an existing pair, preparing delete
[2021/03/17 20:14:12][INFO][cartDelete]  Delete succeeded
[2021/03/17 20:14:12][INFO][cartDelete]  Received a POST /cart/delete request.
[2021/03/17 20:14:12][INFO][cartDelete]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu' AND cart.movie_id = 'tt1345836';
[2021/03/17 20:14:12][INFO][cartDelete]  Query succeeded
[2021/03/17 20:14:12][INFO][cartDelete]  No pair found, ending Delete operation
[2021/03/17 20:14:13][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:14:13][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu'
[2021/03/17 20:14:13][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:14:13][INFO][cartRetrieve]  Found an item
[2021/03/17 20:14:13][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 20:14:13][INFO][sendMovieRequest]  Building client...
[2021/03/17 20:14:13][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 20:14:13][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 20:14:13][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 20:14:13][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 20:14:13][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 20:14:13][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 20:14:13][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:14:13][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu'
[2021/03/17 20:14:13][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:14:13][INFO][cartRetrieve]  Found an item
[2021/03/17 20:14:13][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 20:14:13][INFO][sendMovieRequest]  Building client...
[2021/03/17 20:14:13][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 20:14:13][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 20:14:13][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 20:14:13][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 20:14:13][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 20:14:13][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 20:14:20][INFO][cartUpdate]  Received a POST /cart/update request.
[2021/03/17 20:14:20][INFO][cartUpdate]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 20:14:20][INFO][cartUpdate]  Query succeeded
[2021/03/17 20:14:20][INFO][cartUpdate]  Found a match
[2021/03/17 20:14:20][INFO][cartUpdate]  Found an existing pair, preparing update
[2021/03/17 20:14:20][INFO][cartUpdate]  Update succeeded
[2021/03/17 20:14:20][INFO][cartUpdate]  Received a POST /cart/update request.
[2021/03/17 20:14:20][INFO][cartUpdate]  Running checkExist SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu' AND cart.movie_id = 'tt4154796';
[2021/03/17 20:14:20][INFO][cartUpdate]  Query succeeded
[2021/03/17 20:14:20][INFO][cartUpdate]  Found a match
[2021/03/17 20:14:20][INFO][cartUpdate]  Found an existing pair, preparing update
[2021/03/17 20:14:20][INFO][cartUpdate]  Update succeeded
[2021/03/17 20:14:21][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:14:21][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu'
[2021/03/17 20:14:21][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:14:21][INFO][cartRetrieve]  Found an item
[2021/03/17 20:14:21][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 20:14:21][INFO][sendMovieRequest]  Building client...
[2021/03/17 20:14:21][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 20:14:21][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 20:14:21][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 20:14:21][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 20:14:21][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 20:14:21][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 20:14:21][INFO][cartRetrieve]  Received a POST /cart/retrieve request.
[2021/03/17 20:14:21][INFO][cartRetrieve]  Running getAll SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM cart
WHERE cart.email = 'finalaccount@uci.edu'
[2021/03/17 20:14:21][INFO][cartRetrieve]  Query succeeded
[2021/03/17 20:14:21][INFO][cartRetrieve]  Found an item
[2021/03/17 20:14:21][INFO][sendMovieRequest]  Preparing remote request to Movie endpoint /thumbnail.
[2021/03/17 20:14:21][INFO][sendMovieRequest]  Building client...
[2021/03/17 20:14:21][INFO][sendMovieRequest]  Building WebTarget...
[2021/03/17 20:14:21][INFO][sendMovieRequest]  Sending remote request.
[2021/03/17 20:14:21][INFO][cartRetrieve]  Found a user's cart, preparing to retrieve
[2021/03/17 20:14:21][INFO][cartRetrieve]  Retrieving tt4154796
[2021/03/17 20:14:21][INFO][cartRetrieve]  Running Prices Query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT *
FROM movie_price
WHERE movie_id = 'tt4154796';
[2021/03/17 20:14:21][INFO][cartRetrieve]  Retrieve succeeded
[2021/03/17 20:14:31][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'finalaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'finalaccount@uci.edu';
[2021/03/17 20:14:31][INFO][orderPlace]  Query succeeded
[2021/03/17 20:14:31][INFO][orderPlace]  Found an sale_id: 93
[2021/03/17 20:14:31][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (93,93);
[2021/03/17 20:14:31][INFO][orderPlace]  Sum was 194.96399659371377
[2021/03/17 20:14:32][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 20:14:32][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 20:14:32][INFO][createPayPalOrder]  Order ID: 5MV652465X124050Y
[2021/03/17 20:14:32][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 20:14:32][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (93,'5MV652465X124050Y');
[2021/03/17 20:14:32][INFO][orderPlace]  Getting Order details
[2021/03/17 20:14:32][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T03:14:29Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/5MV652465X124050Y"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=5MV652465X124050Y"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/5MV652465X124050Y"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/5MV652465X124050Y/capture"}],"id":"5MV652465X124050Y","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 20:14:32][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=5MV652465X124050Y
[2021/03/17 20:14:32][INFO][orderPlace]  Running getSale SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: INSERT INTO sale(email, movie_id, quantity, sale_date)
SELECT 'finalaccount@uci.edu', cart.movie_id, quantity, NOW() FROM cart
WHERE email = 'finalaccount@uci.edu';
[2021/03/17 20:14:32][INFO][orderPlace]  Query succeeded
[2021/03/17 20:14:32][INFO][orderPlace]  Found an sale_id: 94
[2021/03/17 20:14:32][INFO][orderPlace]  Calculating Sum with query: 
com.mysql.cj.jdbc.ClientPreparedStatement: SELECT SUM(unit_price*quantity*(1 - discount)) FROM sale
JOIN movie_price ON sale.movie_id = movie_price.movie_id
WHERE sale.sale_id IN (94,94);
[2021/03/17 20:14:32][INFO][orderPlace]  Sum was 194.96399659371377
[2021/03/17 20:14:33][INFO][createPayPalOrder]  Status Code: 201
[2021/03/17 20:14:33][INFO][createPayPalOrder]  Status: CREATED
[2021/03/17 20:14:33][INFO][createPayPalOrder]  Order ID: 50L64559947365352
[2021/03/17 20:14:33][INFO][createPayPalOrder]  *******CREATED ORDER*******
[2021/03/17 20:14:33][INFO][orderPlace]  Putting saleids into transaction table with query: ncom.mysql.cj.jdbc.ClientPreparedStatement: REPLACE INTO transaction(sale_id, token) VALUES (94,'50L64559947365352');
[2021/03/17 20:14:33][INFO][orderPlace]  Getting Order details
[2021/03/17 20:14:33][INFO][getOrder]  Full response body:{"create_time":"2021-03-18T03:14:31Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default"}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/50L64559947365352"},{"method":"GET","rel":"approve","href":"https://www.sandbox.paypal.com/checkoutnow?token=50L64559947365352"},{"method":"PATCH","rel":"update","href":"https://api.sandbox.paypal.com/v2/checkout/orders/50L64559947365352"},{"method":"POST","rel":"capture","href":"https://api.sandbox.paypal.com/v2/checkout/orders/50L64559947365352/capture"}],"id":"50L64559947365352","intent":"CAPTURE","status":"CREATED"}
[2021/03/17 20:14:33][INFO][getOrder]  approve: https://www.sandbox.paypal.com/checkoutnow?token=50L64559947365352
[2021/03/17 20:15:22][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 20:15:24][INFO][captureOrder]  Capture ID: 6BY00871989260701
[2021/03/17 20:15:24][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '6BY00871989260701' WHERE token = '50L64559947365352';
[2021/03/17 20:15:24][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '50L64559947365352';
[2021/03/17 20:15:24][INFO][orderComplete]  Received OrderComplete request
[2021/03/17 20:15:26][INFO][captureOrder]  Something went wrong server-side
[2021/03/17 20:15:26][INFO][captureOrder]  {"name":"UNPROCESSABLE_ENTITY","details":[{"issue":"ORDER_ALREADY_CAPTURED","description":"Order already captured.If 'intent=CAPTURE' only one capture per order is allowed."}],"message":"The requested action could not be performed, semantically incorrect, or failed business validation.","debug_id":"a5d7f2e44672a","links":[{"href":"https://developer.paypal.com/docs/api/orders/v2/#error-ORDER_ALREADY_CAPTURED","rel":"information_link","method":"GET"}]}
[2021/03/17 20:15:26][INFO][orderComplete]  Running getCaptureQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: UPDATE transaction SET capture_id = '-2' WHERE token = '50L64559947365352';
[2021/03/17 20:15:26][INFO][orderComplete]  Running getRelationshipTranSaleQuery SQL query: com.mysql.cj.jdbc.ClientPreparedStatement: SELECT DISTINCT sale.email
FROM sale, transaction
WHERE token = '50L64559947365352';
[2021/03/17 20:15:31][INFO][orderRetrieve]  Found token: 50L64559947365352
[2021/03/17 20:15:31][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T03:15:21Z","create_time":"2021-03-18T03:14:31Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"194.96","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T03:15:21Z","create_time":"2021-03-18T03:15:21Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"5.95","currency_code":"USD"},"gross_amount":{"value":"194.96","currency_code":"USD"},"net_amount":{"value":"189.01","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/6BY00871989260701"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/6BY00871989260701/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/50L64559947365352"}],"id":"6BY00871989260701","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/50L64559947365352"}],"id":"50L64559947365352","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
[2021/03/17 20:15:31][INFO][orderRetrieve]  Found token: 50L64559947365352
[2021/03/17 20:15:32][INFO][getOrderDetailed]  Full response body:{"update_time":"2021-03-18T03:15:21Z","create_time":"2021-03-18T03:14:31Z","purchase_units":[{"payee":{"email_address":"sb-sno965176001@business.example.com","merchant_id":"VG3P7FCTYUUFJ"},"amount":{"value":"194.96","currency_code":"USD"},"reference_id":"default","shipping":{"address":{"country_code":"US","admin_area_1":"CA","address_line_1":"1 Main St","admin_area_2":"San Jose","postal_code":"95131"},"name":{"full_name":"John Doe"}},"payments":{"captures":[{"amount":{"value":"194.96","currency_code":"USD"},"seller_protection":{"dispute_categories":["ITEM_NOT_RECEIVED","UNAUTHORIZED_TRANSACTION"],"status":"ELIGIBLE"},"update_time":"2021-03-18T03:15:21Z","create_time":"2021-03-18T03:15:21Z","final_capture":true,"seller_receivable_breakdown":{"paypal_fee":{"value":"5.95","currency_code":"USD"},"gross_amount":{"value":"194.96","currency_code":"USD"},"net_amount":{"value":"189.01","currency_code":"USD"}},"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/payments/captures/6BY00871989260701"},{"method":"POST","rel":"refund","href":"https://api.sandbox.paypal.com/v2/payments/captures/6BY00871989260701/refund"},{"method":"GET","rel":"up","href":"https://api.sandbox.paypal.com/v2/checkout/orders/50L64559947365352"}],"id":"6BY00871989260701","status":"COMPLETED"}]}}],"links":[{"method":"GET","rel":"self","href":"https://api.sandbox.paypal.com/v2/checkout/orders/50L64559947365352"}],"id":"50L64559947365352","intent":"CAPTURE","payer":{"address":{"country_code":"US"},"email_address":"sb-4zuq435173085@personal.example.com","name":{"surname":"Doe","given_name":"John"},"payer_id":"2C5G9345LRTKU"},"status":"COMPLETED"}
